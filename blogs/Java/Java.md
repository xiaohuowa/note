# IO

> è¾“å…¥è¾“å‡ºéƒ½æ˜¯å¯¹`å†…å­˜`è€Œè¨€çš„

![image-20220810233842361](https://s2.loli.net/2023/10/12/w8aJ9ZGBbRo4uYr.png)



## æµçš„åˆ†ç±»

> è¾“å…¥æµã€è¾“å‡ºæµã€å­—èŠ‚æµã€å­—ç¬¦æµ
>
> ==Streamç»“å°¾çš„éƒ½æ˜¯å­—èŠ‚æµï¼ŒWriterç»“å°¾çš„éƒ½æ˜¯å­—ç¬¦æµ==

### è¾“å…¥æµï¼š

ä»¥å†…å­˜ä½œä¸ºå‚ç…§ç‰©ï¼Œå¾€å†…å­˜ä¸­å»ï¼Œå«åšè¾“å…¥(Input)ã€‚æˆ–è€…å«åšè¯»(Read)ã€‚

### è¾“å‡ºæµï¼š

ä»¥å†…å­˜ä½œä¸ºå‚ç…§ç‰©ï¼Œä»å†…å­˜ä¸­å‡ºæ¥ï¼Œå«åšè¾“å‡º(Output)ã€‚æˆ–è€…å«åšå†™(Write)ã€‚

### å­—èŠ‚æµ

æŒ‰ç…§å­—èŠ‚çš„æ–¹å¼è¯»å–æ•°æ®ï¼Œä¸€æ¬¡è¯»å–1ä¸ªå­—èŠ‚byteï¼Œç­‰åŒäº==ä¸€æ¬¡è¯»å–8ä¸ªäºŒè¿›åˆ¶ä½==ã€‚
è¿™ç§æµæ˜¯ä¸‡èƒ½çš„ï¼Œä»€ä¹ˆç±»å‹çš„æ–‡ä»¶éƒ½å¯ä»¥è¯»å–ã€‚åŒ…æ‹¬ï¼šæ–‡æœ¬æ–‡ä»¶ï¼Œå›¾ç‰‡ï¼Œå£°éŸ³æ–‡ä»¶ï¼Œè§†é¢‘æ–‡ä»¶ç­‰....

~~~
å‡è®¾æ–‡ä»¶file1.txtï¼Œé‡‡ç”¨å­—èŠ‚æµçš„è¯æ˜¯è¿™æ ·è¯»çš„ï¼š
    aä¸­å›½bcå¼ ä¸‰fe
    ç¬¬ä¸€æ¬¡è¯»ï¼šä¸€ä¸ªå­—èŠ‚ï¼Œæ­£å¥½è¯»åˆ°'a'ï¼ˆè¿™é‡Œçš„aå› ä¸ºæ˜¯åœ¨winçš„æ–‡ä»¶ä¸­çš„ï¼Œæ‰€ä»¥å°±ä¸€ä¸ªå­—èŠ‚ã€‚Javaçš„charæ˜¯ä¸¤ä¸ªå­—èŠ‚ï¼‰
    ç¬¬äºŒæ¬¡è¯»ï¼šä¸€ä¸ªå­—èŠ‚ï¼Œæ­£å¥½è¯»åˆ°'ä¸­'å­—ç¬¦çš„ä¸€åŠã€‚
    ç¬¬ä¸‰æ¬¡è¯»ï¼šä¸€ä¸ªå­—èŠ‚ï¼Œæ­£å¥½è¯»åˆ°'ä¸­'å­—ç¬¦çš„å¦å¤–ä¸€åŠã€‚
~~~

â€‹				

### å­—ç¬¦æµ
æœ‰çš„æµæ˜¯æŒ‰ç…§å­—ç¬¦çš„æ–¹å¼è¯»å–æ•°æ®çš„ï¼Œ==ä¸€æ¬¡è¯»å–ä¸€ä¸ªå­—ç¬¦==ï¼Œè¿™ç§æµæ˜¯ä¸ºäº†æ–¹ä¾¿è¯»å–æ™®é€šæ–‡æœ¬æ–‡ä»¶è€Œå­˜åœ¨çš„ï¼Œè¿™ç§æµä¸èƒ½è¯»å–ï¼šå›¾ç‰‡ã€å£°éŸ³ã€è§†é¢‘ç­‰æ–‡ä»¶ã€‚åªèƒ½è¯»å–çº¯æ–‡æœ¬æ–‡ä»¶ï¼ˆè¿wordæ–‡ä»¶éƒ½æ— æ³•è¯»å–ï¼‰ã€‚


	å‡è®¾æ–‡ä»¶file1.txtï¼Œé‡‡ç”¨å­—ç¬¦æµçš„è¯æ˜¯è¿™æ ·è¯»çš„ï¼š
	    aä¸­å›½bcå¼ ä¸‰fe
	    ç¬¬ä¸€æ¬¡è¯»ï¼š'a'å­—ç¬¦ï¼ˆ'a'å­—ç¬¦åœ¨windowsç³»ç»Ÿä¸­å ç”¨1ä¸ªå­—èŠ‚ã€‚ï¼‰
	    ç¬¬äºŒæ¬¡è¯»ï¼š'ä¸­'å­—ç¬¦ï¼ˆ'ä¸­'å­—ç¬¦åœ¨windowsç³»ç»Ÿä¸­å ç”¨2ä¸ªå­—èŠ‚ã€‚ï¼‰





## java.io.*

> Java ä¸­æ‰€æœ‰çš„æµéƒ½æ˜¯åœ¨ï¼š`java.io.*;`ä¸‹ã€‚

**java IOæµå››å¤§å®¶æ—çš„é¦–é¢†ï¼š**

1. java.io.InputStream  å­—èŠ‚è¾“å…¥æµ
2. java.io.OutputStream å­—èŠ‚è¾“å‡ºæµ
3. java.io.Reader		å­—ç¬¦è¾“å…¥æµ
4. java.io.Writer		å­—ç¬¦è¾“å‡ºæµ

**ç‰¹ç‚¹ï¼š**

1. éƒ½æ˜¯æŠ½è±¡ç±»ã€‚(abstract class)
2. **æ‰€æœ‰çš„æµ**éƒ½å®ç°äº†ï¼š`java.io.Closeable`æ¥å£ï¼Œéƒ½æ˜¯å¯å…³é—­çš„ï¼Œéƒ½æœ‰`close()`æ–¹æ³•ã€‚
3. æ‰€æœ‰çš„==è¾“å‡ºæµ==éƒ½å®ç°äº†ï¼š	`java.io.Flushable`æ¥å£ï¼Œéƒ½æ˜¯å¯åˆ·æ–°çš„ï¼Œéƒ½æœ‰`flush()`æ–¹æ³•ã€‚

> æµæ¯•ç«Ÿæ˜¯ä¸€ä¸ªç®¡é“ï¼Œè¿™ä¸ªæ˜¯å†…å­˜å’Œç¡¬ç›˜ä¹‹é—´çš„é€šé“ï¼Œç”¨å®Œä¹‹å==ä¸€å®šè¦å…³é—­==ï¼Œ
> ä¸ç„¶ä¼šè€—è´¹(å ç”¨)å¾ˆå¤šèµ„æºã€‚å…»æˆå¥½ä¹ æƒ¯ï¼Œç”¨å®Œæµä¸€å®šè¦å…³é—­ã€‚

> å…»æˆä¸€ä¸ªå¥½ä¹ æƒ¯ï¼Œè¾“å‡ºæµåœ¨æœ€ç»ˆè¾“å‡ºä¹‹åï¼Œ==ä¸€å®šè¦è®°å¾—flush()==åˆ·æ–°ä¸€ä¸‹ã€‚è¿™ä¸ªåˆ·æ–°è¡¨ç¤ºå°†é€šé“/ç®¡é“å½“ä¸­å‰©ä½™æœªè¾“å‡ºçš„æ•°æ®å¼ºè¡Œè¾“å‡ºå®Œï¼ˆæ¸…ç©ºç®¡é“ï¼ï¼‰åˆ·æ–°çš„ä½œç”¨å°±æ˜¯æ¸…ç©ºç®¡é“ã€‚
> **æ³¨æ„ï¼šå¦‚æœæ²¡æœ‰flush()å¯èƒ½ä¼šå¯¼è‡´ä¸¢å¤±æ•°æ®ã€‚**





## éœ€è¦æŒæ¡çš„16ä¸ªæµ

> java.io åŒ…ä¸‹éœ€è¦æŒæ¡çš„æµæœ‰16ä¸ªï¼š

	æ–‡ä»¶ä¸“å±ï¼š
		java.io.FileInputStreamï¼ˆæŒæ¡ï¼‰
		java.io.FileOutputStreamï¼ˆæŒæ¡ï¼‰
		java.io.FileReader
		java.io.FileWriter
	
	è½¬æ¢æµï¼šï¼ˆå°†å­—èŠ‚æµè½¬æ¢æˆå­—ç¬¦æµï¼‰
		java.io.InputStreamReader
		java.io.OutputStreamWriter
	
	ç¼“å†²æµä¸“å±ï¼š
		java.io.BufferedReader
		java.io.BufferedWriter
		java.io.BufferedInputStream
		java.io.BufferedOutputStream
	
	æ•°æ®æµä¸“å±ï¼š
		java.io.DataInputStream
		java.io.DataOutputStream
	
	æ ‡å‡†è¾“å‡ºæµï¼š
		java.io.PrintWriter
		java.io.PrintStreamï¼ˆæŒæ¡ï¼‰
	
	å¯¹è±¡ä¸“å±æµï¼š
		java.io.ObjectInputStreamï¼ˆæŒæ¡ï¼‰
		java.io.ObjectOutputStreamï¼ˆæŒæ¡ï¼‰



### ğŸ”´ java.io.FileInputStream

> ç»™`FileInputStream`ä¼ è¿›å»ä¸€ä¸ªbyteæ•°ç»„ï¼Œé‚£ä¹ˆæ¯æ¬¡ç”¨è¿™ä¸ªbyteæ•°ç»„å» read çš„æ—¶å€™ï¼Œéƒ½ä¼šå¾€è¿™æ•°ç»„é‡Œè£…å¯¹åº”æ•°é‡çš„byte
>
> ==ä½†æ˜¯==ï¼Œè¯»åˆ°æœ€åå¦‚æœä¸€æ¬¡è¯»åˆ°çš„æ•°é‡æ²¡åˆ°æ•°ç»„é•¿åº¦çš„è¯ï¼Œä¼šæŠŠå‰©ä½™çš„byteä¾æ¬¡ä»æ•°ç»„0ä½å¼€å§‹æ”¾è¿›å»ï¼ˆåŸæœ‰çš„è¦†ç›–ï¼‰ï¼Œè€Œå‰©ä¸‹æ²¡è¦†ç›–çš„ï¼Œè¿˜ä¿ç•™åœ¨é‚£ã€‚
>
> æ‰€ä»¥è¦è½¬æˆå­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œè¦ç”¨Stingçš„æ„é€ æ–¹æ³•ï¼Œä¼ å…¥byteæ•°ç»„ã€èµ·å§‹ä½ç½®ã€å¤šå°‘ä¸ªå­—ç¬¦ã€‚
>
> 1. èµ·å§‹ä½ç½®éƒ½ä»0å¼€å§‹
> 2. ç”¨`.read(bytes)`å¯ä»¥è¿”å›è¯»äº†å¤šå°‘ä¸ªå­—ç¬¦

~~~java
public static void main(String[] args) {
    FileInputStream fis = null;
    try {
        
        // ç”¨ç›¸å¯¹è·¯å¾„ï¼ˆç›¸å¯¹è·¯å¾„çŸ¥è¯†ç‚¹ä»‹ç»åœ¨æ‹“å±•é‡Œï¼‰ï¼Œå¼€ä¸€ä¸ªFileInputStream
        fis = new FileInputStream("chapter23/src/tempfile3");
        // å‡†å¤‡ä¸€ä¸ªbyteæ•°ç»„ï¼Œç»™æ•°ç»„å®šå‡ ä¸ªé•¿åº¦ï¼Œä¸€æ¬¡å°±èƒ½è¯»å‡ ä¸ªå­—èŠ‚byte
        byte[] bytes = new byte[4];
        // æ–¹æ³•ä¸€ï¼Œå†™å¾—ä¸ä¼˜é›…
        /*while(true){
                int readCount = fis.read(bytes);
                if(readCount == -1){
                    break;
                }
                // æŠŠbyteæ•°ç»„è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œè¯»åˆ°å¤šå°‘ä¸ªè½¬æ¢å¤šå°‘ä¸ªã€‚
                System.out.print(new String(bytes, 0, readCount));
            }*/
        // æ–¹æ³•äºŒï¼Œä¼˜é›…
        int readCount = 0;
        // fis.read(bytes)æ˜¯æŠŠåˆšæ‰å®šçš„é•¿åº¦çš„byteæ•°ç»„ä¼ è¿›å»ï¼Œå¯ä»¥æ‹¿åˆ°å¯¹åº”æ•°é‡çš„byteå›æ¥ï¼Œè¿”å›çš„æ˜¯è¯»åˆ°byteçš„æ•°é‡
        while((readCount = fis.read(bytes)) != -1) {
            // é€šè¿‡Stringé‡Œçš„æ„é€ æ–¹æ³•ï¼ŒæŠŠbyteæ•°ç»„ã€èµ·å§‹ä½ç½®ã€å¤šå°‘ä¸ªå­—ç¬¦æ”¾è¿›å»
            System.out.print(new String(bytes, 0, readCount));
        }

    } catch (FileNotFoundException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    } finally {
        if (fis != null) {
            try {
                fis.close();
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
    }
}
~~~



#### int available()ï¼šè¿”å›æµå½“ä¸­å‰©ä½™çš„æ²¡æœ‰è¯»åˆ°çš„å­—èŠ‚æ•°é‡

#### long skip(long n)ï¼šè·³è¿‡å‡ ä¸ªå­—èŠ‚ä¸è¯»ã€‚

~~~java
public static void main(String[] args) {
    FileInputStream fis = null;
    try {
        fis = new FileInputStream("tempfile");
        System.out.println("æ€»å­—èŠ‚æ•°é‡ï¼š" + fis.available());
        // è¯»1ä¸ªå­—èŠ‚
        //int readByte = fis.read();
        // è¿˜å‰©ä¸‹å¯ä»¥è¯»çš„å­—èŠ‚æ•°é‡æ˜¯ï¼š5
        //System.out.println("å‰©ä¸‹å¤šå°‘ä¸ªå­—èŠ‚æ²¡æœ‰è¯»ï¼š" + fis.available());
        // è¿™ä¸ªæ–¹æ³•æœ‰ä»€ä¹ˆç”¨ï¼Ÿ
        // å¯ä»¥åˆ›å‡ºåˆé€‚å¤§å°çš„byteæ•°ç»„ï¼Œå°±èƒ½ä¸€æ¬¡è¯»è¿›æ‰€æœ‰å†…å®¹
        //byte[] bytes = new byte[fis.available()]; // è¿™ç§æ–¹å¼ä¸å¤ªé€‚åˆå¤ªå¤§çš„æ–‡ä»¶ï¼Œå› ä¸ºbyte[]æ•°ç»„ä¸èƒ½å¤ªå¤§ã€‚
        // ä¸éœ€è¦å¾ªç¯äº†ã€‚
        // ç›´æ¥è¯»ä¸€æ¬¡å°±è¡Œäº†ã€‚
        //int readCount = fis.read(bytes); // 6
        //System.out.println(new String(bytes)); // abcdef

        // skipè·³è¿‡å‡ ä¸ªå­—èŠ‚ä¸è¯»å–ï¼Œè¿™ä¸ªæ–¹æ³•ä¹Ÿå¯èƒ½ä»¥åä¼šç”¨ï¼
        fis.skip(3);
        System.out.println(fis.read()); //100 ï¼ˆabcdefçš„æ–‡ä»¶ï¼Œè·³è¿‡3ä¸ªåˆ°dï¼Œdä¸º100ï¼‰

    } catch (FileNotFoundException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    } finally {
        if (fis != null) {
            try {
                fis.close();
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
    }
}
~~~



### ğŸ”´ java.io.FileOutputStream

> `FileOutputStream`ç”¨äºå†™å…¥è¯¸å¦‚å›¾åƒæ•°æ®çš„åŸå§‹å­—èŠ‚æµã€‚  å¯¹äºå†™å…¥å­—ç¬¦æµï¼Œè¯·è€ƒè™‘ä½¿ç”¨`FileWriter` ã€‚
>
> `FileWriter`ç”¨æ³•åŸºæœ¬åŒ`FileOutputStream`ï¼Œå…·ä½“å¯æŸ¥æ‰‹å†Œ
>
> ~~~java
>     public static void main(String[] args) {
>         FileWriter fw = null;
>         try {
>             fw = new FileWriter("chapter23/src/test");
>             fw.write("å¥½å¥½å­¦ä¹ å•Š");
> 
>             // flush() é€šè¿‡å°†ä»»ä½•ç¼“å†²çš„è¾“å‡ºå†™å…¥åº•å±‚æµæ¥åˆ·æ–°æµã€‚
>             fw.flush();
>         } catch (IOException e) {
>             e.printStackTrace();
>         } finally {
>             if (fw != null) {
>                 try {
>                     fw.close();
>                 } catch (IOException e) {
>                     e.printStackTrace();
>                 }
>             }
>         }
>     }
> ~~~

#### æ„é€ æ–¹æ³•

![image-20220811144246318](https://s2.loli.net/2023/10/12/hjdUKv7VQsZpE6S.png)

##### å‚æ•°

1. `name` -ä¸ç³»ç»Ÿç›¸å…³çš„æ–‡ä»¶å
2. `append` - å¦‚æœæ˜¯true ï¼Œé‚£ä¹ˆå­—èŠ‚å°†è¢«å†™å…¥æ–‡ä»¶çš„æœ«å°¾ï¼Œè€Œä¸æ˜¯å¼€å¤´ï¼ˆæ²¡åŠ appendçš„æ„é€ æ–¹æ³•é»˜è®¤æ˜¯ï¼šå­˜åœ¨å°±==æ¸…ç©º==å®Œå†™ï¼Œä¸å­˜åœ¨å°±==æ–°å»º==å†™ï¼›åŠ äº†appendä¸ºtrueä¹‹åä¼šè¿½åŠ åœ¨æœ«å°¾ï¼‰





#### æ‹·è´æ–‡ä»¶

```java
public static void main(String[] args) {
    /**
     * æ‹·è´ä¸€ä¸ªæ–‡ä»¶åˆ°å¦ä¸€ä¸ªåœ°æ–¹
     * ä¸‡èƒ½çš„ï¼Œå›¾ç‰‡å£°éŸ³è§†é¢‘æ–‡æœ¬éƒ½è¡Œ
     */
    // å£°æ˜è¾“å…¥è¾“å‡ºæµå¯¹è±¡
    FileInputStream fis = null;
    FileOutputStream fos = null;

    try {
        // ç»™è¾“å…¥è¾“å‡ºæµåŠ ä¸Šå¯¹åº”çš„ä½ç½®
        fis =  new FileInputStream("E:\\xxxxxxxï¼ˆæºè·¯å¾„ï¼‰");
        fos = new FileOutputStream("D:\\xxxxxxxï¼ˆæ‹·è´ç›®çš„åœ°è·¯å¾„ï¼‰");

        // è‡ªå®šä¹‰ä¸€ä¸ªé•¿åº¦çš„byteæ•°ç»„
        byte[] bytes = new byte[1024]; // æ¯æ¬¡1024å­—èŠ‚æ‹·è´

        // readCountç”¨æ¥æ¥æ”¶æ¯æ¬¡byteæ•°ç»„è¯»åˆ°çš„å­—èŠ‚ä¸ªæ•°
        int readCount = 0;
        while ((readCount = fis.read(bytes)) != -1) {
            // è¾¹è¯»è¾¹å†™
            fos.write(bytes, 0, readCount);
        }
        fos.flush();
    } catch (IOException e) {
        e.printStackTrace();
    } finally {
        if (fis != null) {
            try {
                fis.close();
            } catch (IOException e) {
                e.printStackTrace();
            }
        };
        if (fos != null) {
            try {
                fos.close();
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
    }
}
```





### java.io.BufferedReader

![image-20220811190205697](https://s2.loli.net/2023/10/12/bgyjlcYGwqPTE4O.png)


> `BufferedReader`:
> å¸¦æœ‰ç¼“å†²åŒºçš„å­—ç¬¦è¾“å…¥æµã€‚
> ä½¿ç”¨è¿™ä¸ªæµçš„æ—¶å€™ä¸éœ€è¦è‡ªå®šä¹‰charæ•°ç»„ï¼Œæˆ–è€…è¯´ä¸éœ€è¦è‡ªå®šä¹‰byteæ•°ç»„ã€‚è‡ªå¸¦ç¼“å†²ã€‚
>
> - å½“ä¸€ä¸ªæµçš„æ„é€ æ–¹æ³•ä¸­éœ€è¦ä¸€ä¸ªæµçš„æ—¶å€™ï¼Œè¿™ä¸ªè¢«ä¼ è¿›æ¥çš„æµå«åšï¼š==èŠ‚ç‚¹æµ==ã€‚
> - å¤–éƒ¨è´Ÿè´£åŒ…è£…çš„è¿™ä¸ªæµï¼Œå«åšï¼š==åŒ…è£…æµ==ï¼Œè¿˜æœ‰ä¸€ä¸ªåå­—å«åšï¼š==å¤„ç†æµ==ã€‚
> - `bufferedReader.readLine()`æ–¹æ³•è¯»å–ä¸€ä¸ªæ–‡æœ¬è¡Œï¼Œä½†**ä¸å¸¦æ¢è¡Œç¬¦**ã€‚æ²¡è¯»åˆ°è¿”å›***null***ã€‚
> - å¯¹äºåŒ…è£…æµæ¥è¯´ï¼Œåªéœ€è¦å…³é—­æœ€å¤–å±‚æµå°±è¡Œï¼Œé‡Œé¢çš„èŠ‚ç‚¹æµä¼šè‡ªåŠ¨å…³é—­ã€‚ï¼ˆå¯ä»¥çœ‹æºä»£ç ã€‚ï¼‰
>   - ![image-20220811190639095](https://s2.loli.net/2023/10/12/iEJ2QbCdnp4cVGf.png)
>   - ![image-20220811190625200](https://s2.loli.net/2023/10/12/g7KPC1pNokHOWcQ.png)

~~~java
public static void main(String[] args) throws Exception{

    FileReader reader = new FileReader("Copy02.java");
    // å½“ä¸€ä¸ªæµçš„æ„é€ æ–¹æ³•ä¸­éœ€è¦ä¸€ä¸ªæµçš„æ—¶å€™ï¼Œè¿™ä¸ªè¢«ä¼ è¿›æ¥çš„æµå«åšï¼šèŠ‚ç‚¹æµã€‚
    // å¤–éƒ¨è´Ÿè´£åŒ…è£…çš„è¿™ä¸ªæµï¼Œå«åšï¼šåŒ…è£…æµï¼Œè¿˜æœ‰ä¸€ä¸ªåå­—å«åšï¼šå¤„ç†æµã€‚
    // åƒå½“å‰è¿™ä¸ªç¨‹åºæ¥è¯´ï¼šFileReaderå°±æ˜¯ä¸€ä¸ªèŠ‚ç‚¹æµã€‚BufferedReaderå°±æ˜¯åŒ…è£…æµ/å¤„ç†æµã€‚
    BufferedReader br = new BufferedReader(reader);
    // è¯»ä¸€è¡Œ
    /*String firstLine = br.readLine();
        System.out.println(firstLine);

        String secondLine = br.readLine();
        System.out.println(secondLine);

        String line3 = br.readLine();
        System.out.println(line3);*/

    // å¯ä»¥æŠŠä¸Šé¢è¿™æ®µæ”¹æˆä¸‹é¢è¿™æ ·å¾ªç¯è¯»
    // br.readLine()æ–¹æ³•è¯»å–ä¸€ä¸ªæ–‡æœ¬è¡Œï¼Œä½†ä¸å¸¦æ¢è¡Œç¬¦ã€‚
    String s = null;
    while((s = br.readLine()) != null){
        System.out.print(s);
    }

    // å…³é—­æµ
    // å¯¹äºåŒ…è£…æµæ¥è¯´ï¼Œåªéœ€è¦å…³é—­æœ€å¤–å±‚æµå°±è¡Œï¼Œé‡Œé¢çš„èŠ‚ç‚¹æµä¼šè‡ªåŠ¨å…³é—­ã€‚ï¼ˆå¯ä»¥çœ‹æºä»£ç ã€‚ï¼‰
    br.close();
}
~~~





### è½¬æ¢æµï¼š

#### java.io.InputStreamReader

==java.io.OutputStreamReader==ä¹Ÿç±»ä¼¼ç”¨æ³•ã€‚

> å°† å­—èŠ‚æµ è½¬æ¢æˆ å­—ç¬¦æµã€‚
>
> åœ¨å„ä¸ªæµçš„å¥—å¨ƒä¸­ï¼ŒèŠ‚ç‚¹æµå’ŒåŒ…è£…æµéƒ½æ˜¯ç›¸å¯¹çš„ï¼Œè¦çœ‹æƒ…å†µã€‚

```java
public static void main(String[] args) throws Exception{

    /*// å­—èŠ‚æµ
    FileInputStream in = new FileInputStream("filePath");

    // é€šè¿‡è½¬æ¢æµè½¬æ¢ï¼ˆInputStreamReaderå°†å­—èŠ‚æµè½¬æ¢æˆå­—ç¬¦æµã€‚ï¼‰
    // inæ˜¯èŠ‚ç‚¹æµã€‚readeræ˜¯åŒ…è£…æµã€‚
    InputStreamReader reader = new InputStreamReader(in);

    // è¿™ä¸ªæ„é€ æ–¹æ³•åªèƒ½ä¼ ä¸€ä¸ªå­—ç¬¦æµã€‚ä¸èƒ½ä¼ å­—èŠ‚æµã€‚
    // readeræ˜¯èŠ‚ç‚¹æµã€‚bræ˜¯åŒ…è£…æµã€‚
    BufferedReader br = new BufferedReader(reader);*/

    // ä¸Šé¢çš„åˆå¹¶å†™æ³•
    BufferedReader br = new BufferedReader(new InputStreamReader(new FileInputStream("filePath")));

    String line = null;
    while((line = br.readLine()) != null){
        System.out.println(line);
    }

    // å…³é—­æœ€å¤–å±‚
    br.close();
}
```





### æ•°æ®æµä¸“å±

1. `java.io.DataInputStream`
2. `java.io.DataOutputStream`

> ç”¨å¾—å°‘ï¼Œç±»ä¼¼äºåŠ å¯†ä¸€æ ·
>
> åœ¨ç”¨`DataOutputStream`æŒ‰ç…§ä¸€å®šé¡ºåºå†™ä¸€ä¸ªæ–‡ä»¶åï¼Œä¸€å®šè¦ç”¨`DataInputStream`ä»¥ç›¸åŒçš„ç±»å‹ç›¸åŒçš„é¡ºåºå–å‡ºæ‰è¡Œã€‚

~~~java
public static void main(String[] args) throws Exception{
    // åˆ›å»ºæ•°æ®ä¸“å±çš„å­—èŠ‚è¾“å‡ºæµ
    DataOutputStream dos = new DataOutputStream(new FileOutputStream("data"));
    // å†™æ•°æ®
    byte b = 100;
    short s = 200;
    int i = 300;
    long l = 400L;
    float f = 3.0F;
    double d = 3.14;
    boolean sex = false;
    char c = 'a';
    // å†™
    dos.writeByte(b); // æŠŠæ•°æ®ä»¥åŠæ•°æ®çš„ç±»å‹ä¸€å¹¶å†™å…¥åˆ°æ–‡ä»¶å½“ä¸­ã€‚
    dos.writeShort(s);
    dos.writeInt(i);
    dos.writeLong(l);
    dos.writeFloat(f);
    dos.writeDouble(d);
    dos.writeBoolean(sex);
    dos.writeChar(c);

    // åˆ·æ–°
    dos.flush();
    // å…³é—­æœ€å¤–å±‚
    dos.close();
}
~~~

```java
public static void main(String[] args) throws Exception{
    DataInputStream dis = new DataInputStream(new FileInputStream("data"));
    // å¼€å§‹è¯»
    // ä¸€å®šè¦æŒ‰é¡ºåºï¼ŒæŒ‰ç±»å‹è¯»æ‰è¡Œ
    byte b = dis.readByte();
    short s = dis.readShort();
    int i = dis.readInt();
    long l = dis.readLong();
    float f = dis.readFloat();
    double d = dis.readDouble();
    boolean sex = dis.readBoolean();
    char c = dis.readChar();

    System.out.println(b);
    System.out.println(s);
    System.out.println(i + 1000);
    System.out.println(l);
    System.out.println(f);
    System.out.println(d);
    System.out.println(sex);
    System.out.println(c);

    dis.close();
}
```





### ğŸ”´ æ ‡å‡†è¾“å‡ºæµ

1. `java.io.PrintWriter`
2. `java.io.PrintStream`ï¼ˆæŒæ¡ï¼‰



#### `java.io.PrintStream`

> æ ‡å‡†çš„å­—èŠ‚è¾“å‡ºæµã€‚é»˜è®¤è¾“å‡ºåˆ°æ§åˆ¶å°ã€‚
>
> æ ‡å‡†æµä¸éœ€è¦æ‰‹åŠ¨å…³é—­ã€‚
>
> å¯ä»¥ç»™ä¸€ä¸ªè¾“å‡ºæµ`OutputStream`ï¼Œæ¥ä¿®æ”¹æ ‡å‡†æµçš„æŒ‡å‘ï¼Œå†ç”¨`System.setOut(printStream);`æ¥ä¿®æ”¹è¾“å‡ºæ–¹å‘ã€‚
>
> ![image-20220811202958866](https://s2.loli.net/2023/10/12/MdZ78nvGKVcOCsk.png)

```java
public static void main(String[] args) throws Exception{

    // è”åˆèµ·æ¥å†™
    System.out.println("hello world!");

    // åˆ†å¼€å†™
    PrintStream ps = System.out;
    ps.println("hello zhangsan");
    ps.println("hello lisi");
    ps.println("hello wangwu");

    // æ ‡å‡†è¾“å‡ºæµä¸éœ€è¦æ‰‹åŠ¨close()å…³é—­ã€‚
    // å¯ä»¥æ”¹å˜æ ‡å‡†è¾“å‡ºæµçš„è¾“å‡ºæ–¹å‘

    // æ ‡å‡†è¾“å‡ºæµä¸å†æŒ‡å‘æ§åˆ¶å°ï¼ŒæŒ‡å‘â€œlogâ€æ–‡ä»¶ã€‚
    PrintStream printStream = new PrintStream(new FileOutputStream("log"));
    // ä¿®æ”¹è¾“å‡ºæ–¹å‘ï¼Œå°†è¾“å‡ºæ–¹å‘ä¿®æ”¹åˆ°"log"æ–‡ä»¶ã€‚
    System.setOut(printStream);
    // å†è¾“å‡º
    System.out.println("hello world");
    System.out.println("hello kitty");
    System.out.println("hello zhangsan");

}
```



é€šè¿‡æ”¹å˜æ ‡å‡†è¾“å‡ºæµæ¥å®ç°è®°å½•æ—¥å¿—çš„å·¥å…·ç±»

```java
/*
æ—¥å¿—å·¥å…·
 */
public class Logger {
    /*
    è®°å½•æ—¥å¿—çš„æ–¹æ³•ã€‚
     */
    public static void log(String msg) {
        try {
            // æŒ‡å‘ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶
            PrintStream out = new PrintStream(new FileOutputStream("log.txt", true));
            // æ”¹å˜è¾“å‡ºæ–¹å‘
            System.setOut(out);
            // æ—¥æœŸå½“å‰æ—¶é—´
            Date nowTime = new Date();
            SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss SSS");
            String strTime = sdf.format(nowTime);

            System.out.println(strTime + ": " + msg);
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        }
    }
}
```





### File

> - æ–‡ä»¶å’Œç›®å½•è·¯å¾„åçš„æŠ½è±¡è¡¨ç¤ºã€‚
> - ç”¨çš„æ—¶å€™æŸ¥æ–‡æ¡£å³å¯

- - | è¿”å›å€¼ç±»å‹ | æ–¹æ³•                                                         |
    | ---------- | ------------------------------------------------------------ |
    | `int`      | `compareTo(File pathname)`  æ¯”è¾ƒä¸¤ä¸ªæŠ½è±¡çš„è·¯å¾„åå­—å…¸ã€‚       |
    | `boolean`  | `createNewFile()`  å½“ä¸”ä»…å½“å…·æœ‰è¯¥åç§°çš„æ–‡ä»¶å°šä¸å­˜åœ¨æ—¶ï¼ŒåŸå­åœ°åˆ›å»ºä¸€ä¸ªç”±è¯¥æŠ½è±¡è·¯å¾„åå‘½åçš„æ–°çš„ç©ºæ–‡ä»¶ã€‚ |
    | `boolean`  | `delete()`  åˆ é™¤ç”±æ­¤æŠ½è±¡è·¯å¾„åè¡¨ç¤ºçš„æ–‡ä»¶æˆ–ç›®å½•ã€‚             |
    | `boolean`  | `exists()`  æµ‹è¯•æ­¤æŠ½è±¡è·¯å¾„åè¡¨ç¤ºçš„æ–‡ä»¶æˆ–ç›®å½•æ˜¯å¦å­˜åœ¨ã€‚       |
    | `File`     | `getAbsoluteFile()`  è¿”å›æ­¤æŠ½è±¡è·¯å¾„åçš„ç»å¯¹å½¢å¼ã€‚            |
    | `String`   | `getAbsolutePath()`  è¿”å›æ­¤æŠ½è±¡è·¯å¾„åçš„ç»å¯¹è·¯å¾„åå­—ç¬¦ä¸²ã€‚    |
    | `String`   | `getName()`  è¿”å›ç”±æ­¤æŠ½è±¡è·¯å¾„åè¡¨ç¤ºçš„æ–‡ä»¶æˆ–ç›®å½•çš„åç§°ã€‚      |
    | `String`   | `getParent()`  è¿”å›æ­¤æŠ½è±¡è·¯å¾„åçš„çˆ¶ `null`çš„è·¯å¾„åå­—ç¬¦ä¸²ï¼Œå¦‚æœæ­¤è·¯å¾„åæœªå‘½åä¸ºçˆ¶ç›®å½•ï¼Œåˆ™è¿”å›nullã€‚ |
    | `File`     | `getParentFile()`  è¿”å›æ­¤æŠ½è±¡è·¯å¾„åçš„çˆ¶ï¼Œæˆ–æŠ½è±¡è·¯å¾„å `null`å¦‚æœæ­¤è·¯å¾„åæ²¡æœ‰æŒ‡å®šçˆ¶ç›®å½•ã€‚ |
    | `String`   | `getPath()`  å°†æ­¤æŠ½è±¡è·¯å¾„åè½¬æ¢ä¸ºè·¯å¾„åå­—ç¬¦ä¸²ã€‚              |
    | `boolean`  | `isAbsolute()`  æµ‹è¯•è¿™ä¸ªæŠ½è±¡è·¯å¾„åæ˜¯å¦æ˜¯ç»å¯¹çš„ã€‚             |
    | `boolean`  | `isDirectory()`  æµ‹è¯•æ­¤æŠ½è±¡è·¯å¾„åè¡¨ç¤ºçš„æ–‡ä»¶æ˜¯å¦ä¸ºç›®å½•ã€‚      |
    | `boolean`  | `isFile()`  æµ‹è¯•æ­¤æŠ½è±¡è·¯å¾„åè¡¨ç¤ºçš„æ–‡ä»¶æ˜¯å¦ä¸ºæ™®é€šæ–‡ä»¶ã€‚       |
    | `boolean`  | `isHidden()`  æµ‹è¯•æ­¤æŠ½è±¡è·¯å¾„åå‘½åçš„æ–‡ä»¶æ˜¯å¦ä¸ºéšè—æ–‡ä»¶ã€‚     |
    | `long`     | `lastModified()`  è¿”å›æ­¤æŠ½è±¡è·¯å¾„åè¡¨ç¤ºçš„æ–‡ä»¶ä¸Šæ¬¡ä¿®æ”¹çš„æ—¶é—´ã€‚ |
    | `long`     | `length()`  è¿”å›ç”±æ­¤æŠ½è±¡è·¯å¾„åè¡¨ç¤ºçš„æ–‡ä»¶çš„é•¿åº¦ï¼ˆå¤šå°‘å­—èŠ‚ï¼‰ã€‚ |
    | `String[]` | `list()`  è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼Œå‘½åç”±æ­¤æŠ½è±¡è·¯å¾„åè¡¨ç¤ºçš„ç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•ã€‚ |
    | `String[]` | `list(FilenameFilter filter)`  è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼Œå‘½åç”±æ­¤æŠ½è±¡è·¯å¾„åè¡¨ç¤ºçš„ç›®å½•ä¸­æ»¡è¶³æŒ‡å®šè¿‡æ»¤å™¨çš„æ–‡ä»¶å’Œç›®å½•ã€‚ |
    | `File[]`   | `listFiles()`  è¿”å›ä¸€ä¸ªæŠ½è±¡è·¯å¾„åæ•°ç»„ï¼Œè¡¨ç¤ºç”±è¯¥æŠ½è±¡è·¯å¾„åè¡¨ç¤ºçš„ç›®å½•ä¸­çš„æ–‡ä»¶ã€‚ |
    | `File[]`   | `listFiles(FileFilter filter)`  è¿”å›ä¸€ä¸ªæŠ½è±¡è·¯å¾„åæ•°ç»„ï¼Œè¡¨ç¤ºç”±æ­¤æŠ½è±¡è·¯å¾„åè¡¨ç¤ºçš„æ»¡è¶³æŒ‡å®šè¿‡æ»¤å™¨çš„ç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•ã€‚ |
    | `File[]`   | `listFiles(FilenameFilter filter)`  è¿”å›ä¸€ä¸ªæŠ½è±¡è·¯å¾„åæ•°ç»„ï¼Œè¡¨ç¤ºç”±æ­¤æŠ½è±¡è·¯å¾„åè¡¨ç¤ºçš„æ»¡è¶³æŒ‡å®šè¿‡æ»¤å™¨çš„ç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•ã€‚ |
    | `boolean`  | `mkdir()`  åˆ›å»ºç”±æ­¤æŠ½è±¡è·¯å¾„åå‘½åçš„ç›®å½•ã€‚                    |
    | `boolean`  | `mkdirs()`  åˆ›å»ºç”±æ­¤æŠ½è±¡è·¯å¾„åå‘½åçš„ç›®å½•ï¼ŒåŒ…æ‹¬ä»»ä½•å¿…éœ€ä½†ä¸å­˜åœ¨çš„çˆ¶ç›®å½•ã€‚ |
    | `boolean`  | `renameTo(File dest)`  é‡å‘½åç”±æ­¤æŠ½è±¡è·¯å¾„åè¡¨ç¤ºçš„æ–‡ä»¶ã€‚      |
    | `boolean`  | `setLastModified(long time)`  è®¾ç½®ç”±æ­¤æŠ½è±¡è·¯å¾„åå‘½åçš„æ–‡ä»¶æˆ–ç›®å½•çš„æœ€åä¿®æ”¹æ—¶é—´ã€‚ |









### ğŸ”´ å¯¹è±¡ä¸“å±æµï¼š

1. `java.io.ObjectInputStream`ï¼ˆæŒæ¡ï¼‰
2. `java.io.ObjectOutputStream`ï¼ˆæŒæ¡ï¼‰



#### åºåˆ—åŒ–å’Œååºåˆ—åŒ–

##### 1ã€java.io.NotSerializableException:

â€‹    Studentå¯¹è±¡ä¸æ”¯æŒåºåˆ—åŒ–ï¼ï¼ï¼ï¼

##### 2ã€å‚ä¸åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„å¯¹è±¡ï¼Œå¿…é¡»å®ç°Serializableæ¥å£ã€‚

##### 3ã€æ³¨æ„ï¼šé€šè¿‡æºä»£ç å‘ç°ï¼ŒSerializableæ¥å£åªæ˜¯ä¸€ä¸ªæ ‡å¿—æ¥å£ï¼š

~~~java
public interface Serializable {
}
~~~

> è¿™ä¸ªæ¥å£å½“ä¸­ä»€ä¹ˆä»£ç éƒ½æ²¡æœ‰ã€‚èµ·åˆ°**æ ‡è¯†çš„ä½œç”¨**
>
> Serializableè¿™ä¸ªæ ‡å¿—æ¥å£æ˜¯ç»™javaè™šæ‹Ÿæœºå‚è€ƒçš„ï¼Œjavaè™šæ‹Ÿæœºçœ‹åˆ°è¿™ä¸ªæ¥å£ä¹‹åï¼Œä¼šä¸ºè¯¥ç±»è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªåºåˆ—åŒ–ç‰ˆæœ¬å·ã€‚



##### 4. transient

å¸¦æœ‰`transient`çš„å±æ€§è¡¨ç¤ºä¸å¯åºåˆ—åŒ–ï¼Œå³åœ¨åºåˆ—åŒ–çš„æ—¶å€™è¯¥å±æ€§ä¸å‚ä¸ï¼Œååºåˆ—åŒ–å›æ¥ä¹‹åæ˜¯ç©º



##### 5ã€åºåˆ—åŒ–ç‰ˆæœ¬å·æœ‰ä»€ä¹ˆç”¨ï¼Ÿ

> ä¸€ä¸ªç±»åœ¨ä¿®æ”¹åå°±ä¼šæ”¹å˜è¿™ä¸ªåºåˆ—åŒ–ç‰ˆæœ¬å·ï¼Œå¦‚æœåœ¨ååºåˆ—åŒ–çš„æ—¶å€™ç‰ˆæœ¬å·ä¸ä¸€è‡´å°±ä¼šæŠ¥é”™ã€‚

è‡ªåŠ¨ç”Ÿæˆåºåˆ—å·**ä¼˜ç‚¹**ï¼š

ä¸åŒçš„äººç¼–å†™äº†åŒä¸€ä¸ªç±»ï¼Œä½†â€œè¿™ä¸¤ä¸ªç±»ç¡®å®ä¸æ˜¯åŒä¸€ä¸ªç±»â€ã€‚è¿™ä¸ªæ—¶å€™åºåˆ—åŒ–ç‰ˆæœ¬å°±èµ·ä¸Šä½œç”¨äº†ã€‚å¯¹äºjavaè™šæ‹Ÿæœºæ¥è¯´ï¼Œjavaè™šæ‹Ÿæœºæ˜¯å¯ä»¥åŒºåˆ†å¼€è¿™ä¸¤ä¸ªç±»çš„ï¼Œå› ä¸ºè¿™ä¸¤ä¸ªç±»éƒ½å®ç°äº†Serializableæ¥å£ï¼Œéƒ½æœ‰é»˜è®¤çš„åºåˆ—åŒ–ç‰ˆæœ¬å·ï¼Œä»–ä»¬çš„åºåˆ—åŒ–ç‰ˆæœ¬å·ä¸ä¸€æ ·ã€‚æ‰€ä»¥åŒºåˆ†å¼€äº†ã€‚

è‡ªåŠ¨ç”Ÿæˆåºåˆ—å·**ç¼ºç‚¹ï¼š**

ä¸€æ—¦ä»£ç ç¡®å®šä¹‹åï¼Œä¸èƒ½è¿›è¡Œåç»­çš„ä¿®æ”¹ï¼Œå› ä¸ºåªè¦ä¿®æ”¹ï¼Œå¿…ç„¶ä¼šé‡æ–°ç¼–è¯‘ï¼Œæ­¤æ—¶ä¼šç”Ÿæˆå…¨æ–°çš„åºåˆ—åŒ–ç‰ˆæœ¬å·ï¼Œè¿™ä¸ªæ—¶å€™javaè™šæ‹Ÿæœºä¼šè®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªå…¨æ–°çš„ç±»ã€‚

##### javaè¯­è¨€ä¸­æ˜¯é‡‡ç”¨ä»€ä¹ˆæœºåˆ¶æ¥åŒºåˆ†ç±»çš„ï¼Ÿ

â€‹    ç¬¬ä¸€ï¼šé¦–å…ˆé€šè¿‡ç±»åè¿›è¡Œæ¯”å¯¹ï¼Œå¦‚æœç±»åä¸ä¸€æ ·ï¼Œè‚¯å®šä¸æ˜¯åŒä¸€ä¸ªç±»ã€‚
â€‹    ç¬¬äºŒï¼šå¦‚æœç±»åä¸€æ ·ï¼Œå†æ€ä¹ˆè¿›è¡Œç±»çš„åŒºåˆ«ï¼Ÿé åºåˆ—åŒ–ç‰ˆæœ¬å·è¿›è¡ŒåŒºåˆ†ã€‚



##### æ€»ç»“

> å‡¡æ˜¯ä¸€ä¸ªç±»å®ç°äº†`Serializable`æ¥å£ï¼Œå»ºè®®æ‰‹åŠ¨ç»™è¯¥ç±»æä¾›ä¸€ä¸ªå›ºå®šä¸å˜çš„åºåˆ—åŒ–ç‰ˆæœ¬å·ã€‚
> è¿™æ ·ï¼Œä»¥åè¿™ä¸ªç±»å³ä½¿ä»£ç ä¿®æ”¹äº†ï¼Œä½†æ˜¯ç‰ˆæœ¬å·ä¸å˜ï¼Œjavaè™šæ‹Ÿæœºä¼šè®¤ä¸ºæ˜¯åŒä¸€ä¸ªç±»ã€‚
>
> IDEAä¸­çš„å¿«æ·é”®æ˜¯åœ¨å®ç°`Serializable`æ¥å£çš„ç±»åä¸Š`Alt` +`Enter`å¯ä»¥æ·»åŠ éšæœºçš„ç‰ˆæœ¬å·ï¼ˆç‰ˆæœ¬å·è‡ªå·±éšä¾¿å†™ä¹Ÿè¡Œï¼‰

![image-20220812192901710](https://s2.loli.net/2023/10/12/fU8ExZ2qPuAB1kS.png)



### IOå’ŒProperties

[é€šè¿‡java.utilä¸‹çš„èµ„æºç»‘å®šå™¨å¯ä»¥æ›´æ–¹ä¾¿è·å–propertiesæ–‡ä»¶](# èµ„æºç»‘å®šå™¨)

> åœ¨Javaä¸­ï¼Œå¯ä»¥æŠŠä¸€äº›å˜åŒ–çš„å±æ€§æå–åˆ°`.properties`çš„å±æ€§é…ç½®æ–‡ä»¶é‡Œï¼ˆå¯ä»¥ä¸ç”¨è¿™ä¸ªåç¼€ï¼Œä½†é€šå¸¸æ˜¯è¿™ä¸ªï¼‰ï¼Œé€šè¿‡`Properties`+`IO`å¯ä»¥è¯»å‡ºé…ç½®é¡¹ã€‚
>
> 1. å±æ€§é…ç½®æ–‡ä»¶é‡Œå†™æ³•ä¸€èˆ¬æ˜¯`key=value`æˆ–`key:value`ï¼Œ**ä¸è¦éšä¾¿åŠ ç©ºæ ¼**

é€šè¿‡`load`å¯ä»¥æŠŠå±æ€§é…ç½®æ–‡ä»¶çš„å†…å®¹è£…è½½åˆ°`Propertieså¯¹è±¡`ä¸­

```java
public static void main(String[] args) throws Exception{
    /*
        Propertiesæ˜¯ä¸€ä¸ªMapé›†åˆï¼Œkeyå’Œvalueéƒ½æ˜¯Stringç±»å‹ã€‚
        æƒ³å°†æŸä¸ªæ–‡ä»¶ä¸­çš„æ•°æ®åŠ è½½åˆ°Propertieså¯¹è±¡å½“ä¸­ã€‚
     */
    // æ–°å»ºä¸€ä¸ªè¾“å…¥æµå¯¹è±¡
    FileReader reader = new FileReader("xxxx.properties");

    // æ–°å»ºä¸€ä¸ªMapé›†åˆ
    Properties pro = new Properties();

    // è°ƒç”¨Propertieså¯¹è±¡çš„loadæ–¹æ³•å°†æ–‡ä»¶ä¸­çš„æ•°æ®åŠ è½½åˆ°Mapé›†åˆä¸­ã€‚
    pro.load(reader); // æ–‡ä»¶ä¸­çš„æ•°æ®é¡ºç€ç®¡é“åŠ è½½åˆ°Mapé›†åˆä¸­ï¼Œå…¶ä¸­ç­‰å·=å·¦è¾¹åškeyï¼Œå³è¾¹åšvalue

    // é€šè¿‡keyæ¥è·å–value
    String username = pro.getProperty("username");
    System.out.println(username);

    String password = pro.getProperty("password");
    System.out.println(password);
}
```







# å¤šçº¿ç¨‹

## ç®€ä»‹

1. Javaä¸­==è‡³å°‘ä¸¤ä¸ªçº¿ç¨‹==ï¼šä¸€ä¸ªæ˜¯åƒåœ¾å›æ”¶çº¿ç¨‹ï¼Œä¸€ä¸ªæ˜¯æ‰§è¡Œmainæ–¹æ³•çš„ä¸»çº¿ç¨‹
2. åœ¨Javaä¸­ï¼Œå„çº¿ç¨‹çš„**å †å†…å­˜å’Œæ–¹æ³•åŒºå†…å­˜å…±äº«**ã€‚ä½†æ˜¯==æ ˆå†…å­˜ç‹¬ç«‹==ï¼Œ<u>ä¸€ä¸ªçº¿ç¨‹ä¸€ä¸ªæ ˆ</u>ã€‚
3. ==æ¯ä¸ªçº¿ç¨‹äº’ä¸å¹²æ‰°==ï¼Œæ‰€ä»¥å¯èƒ½å‡ºç°mainæ–¹æ³•æ‰€åœ¨çš„ä¸»æ ˆç»“æŸäº†ä¹‹åç¨‹åºè¿˜æ²¡ç»“æŸ



## Javaå®ç°å¤šçº¿ç¨‹çš„ä¸¤ç§æ–¹å¼

### ä¸€ã€ç¼–å†™ç±»ç»§æ‰¿`Thread`

[ç¬¬ä¸‰ç§çº¿ç¨‹å†™æ³•ï¼ˆå¯ä»¥å¾—åˆ°çº¿ç¨‹çš„è¿”å›å€¼ï¼‰](# ä¸‰ã€ç¬¬ä¸‰ç§çº¿ç¨‹å†™æ³•)

> ç›´æ¥ç»§æ‰¿`java.lang.Thread`ï¼Œé‡å†™runæ–¹æ³•ã€‚
>
> `run()`æ–¹æ³•**ä¸èƒ½**`throws`å¼‚å¸¸ï¼ï¼å› ä¸º[å­ç±»ä¸èƒ½æŠ›å‡ºæ¯”çˆ¶ç±»æ›´å¤šçš„å¼‚å¸¸ï¼ï¼ï¼ï¼ï¼ï¼ï¼](# å¼‚å¸¸)

> åœ¨è¿™ä¸ªç±»ä¸­ï¼Œ**runæ–¹æ³•æ˜¯==å¿…é¡»è¦æœ‰==çš„**
>
> ç”¨çº¿ç¨‹å¯¹è±¡`t.start();`å’Œ`t.run();`æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ
>
> - `t.start();`è¿™è¡Œä»£ç çš„ä½œç”¨å°±æ˜¯**å¼€å¯æ–°çº¿ç¨‹**ï¼ˆåœ¨å®é™…ä¸Šåº•å±‚æ˜¯é€šè¿‡Threadçš„start()æ–¹æ³•é‡Œç”±JVMè°ƒç”¨`start0()æ–¹æ³•`æ¥é€šè¿‡å¤šçº¿ç¨‹æœºåˆ¶è°ƒç”¨runæ–¹æ³•ï¼‰ï¼ˆçº¿ç¨‹ä¸ä¼šç«‹é©¬æ‰§è¡Œï¼Œåªæ˜¯å˜æˆäº†å¯è¿è¡ŒçŠ¶æ€ï¼Œç­‰å¾…CPUè°ƒåº¦ï¼‰ï¼Œå¼€å¯ä¹‹åè¿™è¡Œ**ç«‹é©¬ç»“æŸ**ï¼ˆåŸæ¥çš„çº¿ç¨‹å¯ä»¥ç»§ç»­å¹²ä¸‹é¢çš„äº‹æƒ…ï¼‰ã€‚
> - `t.run();`å¹¶æ²¡æœ‰å¼€å¯æ–°çº¿ç¨‹ï¼Œ**åªæ˜¯è°ƒç”¨äº†ç±»ä¸­çš„runæ–¹æ³•è€Œå·²**ï¼ˆåŸæ¥çš„çº¿ç¨‹å¿…é¡»ç­‰`t.run()`æ‰§è¡Œç»“æŸäº†ä¹‹åæ‰èƒ½ç»§ç»­æ‰§è¡Œä¸‹é¢çš„ä»£ç ï¼‰
>
> 
>
> `start0()æ–¹æ³•`ï¼ˆæ˜¯ä¸ªæœ¬åœ°æ–¹æ³•ï¼Œåº•å±‚æ˜¯C / C++å®ç°çš„ï¼‰ï¼šåœ¨æ‰§è¡Œ`t.start();`ä¹‹åï¼Œå®é™…ä¸Šåº•å±‚æ˜¯é€šè¿‡Threadçš„start()æ–¹æ³•é‡Œç”±JVMè°ƒç”¨`start0()æ–¹æ³•`æ¥é€šè¿‡å¤šçº¿ç¨‹æœºåˆ¶è°ƒç”¨runæ–¹æ³•ã€‚

```java
ç¬¬ä¸€ç§æ–¹å¼ï¼šç¼–å†™ä¸€ä¸ªç±»ï¼Œç›´æ¥ç»§æ‰¿java.lang.Threadï¼Œé‡å†™runæ–¹æ³•ã€‚
	// å®šä¹‰çº¿ç¨‹ç±»
	public class MyThread extends Thread{
		public void run(){
		
		}
	}
	// åˆ›å»ºçº¿ç¨‹å¯¹è±¡
	MyThread t = new MyThread();
	// å¯åŠ¨çº¿ç¨‹ã€‚
	t.start();
```





### äºŒã€ç¼–å†™ç±»å®ç°`Runnable`æ¥å£ï¼ˆå¸¸ç”¨ï¼‰

> 1. ç¼–å†™ä¸€ä¸ªç±»ï¼Œå®ç°`java.lang.Runnable`æ¥å£ï¼Œå®ç°runæ–¹æ³•ã€‚
> 2. å®ä¾‹åŒ–ä¸€ä¸ªThreadå¯¹è±¡ï¼ŒåŒæ—¶ä¼ å…¥åˆšæ‰çš„ç±»çš„å®ä¾‹
> 3. é€šè¿‡Threadå¯¹è±¡çš„start()æ–¹æ³•å¼€å¯çº¿ç¨‹

==æ³¨æ„==ï¼šè¿™ç§å®ç°æ¥å£æ–¹å¼æ¯”è¾ƒ**å¸¸ç”¨**ï¼Œå› ä¸ºä¸€ä¸ªç±»å®ç°äº†æ¥å£ï¼Œå®ƒ**è¿˜å¯ä»¥å»ç»§æ‰¿å…¶å®ƒçš„ç±»ï¼Œæ›´çµæ´»**

>  Threadæ„é€ æ–¹æ³•å¯ä»¥ä¼ ä¸€ä¸ªRunnableå¯¹è±¡
>
> ![image-20220813115123288](https://s2.loli.net/2023/10/12/uwEmtkryGhbv29d.png)


```java
// å®šä¹‰ä¸€ä¸ªå¯è¿è¡Œçš„ç±»
public class MyRunnable implements Runnable {
    public void run(){

    }
}
// åˆ›å»ºçº¿ç¨‹å¯¹è±¡
Thread t = new Thread(new MyRunnable());
// å¯åŠ¨çº¿ç¨‹
t.start();
```



#### æ¨¡æ‹ŸThread

```java
/**
 * æ¨¡æ‹ŸThreadï¼ˆé™æ€ä»£ç†æ¨¡å¼ï¼‰
 */
class MyThreadProxy implements Runnable {

    private Runnable target;

    @Override
    public void run() {
        if (target != null) {
            target.run();
        }
    }

    public MyThreadProxy(Runnable target) {
        this.target = target;
    }

    public void start() {
        // ç”±JVMè°ƒç”¨nativeæ–¹æ³•start0
        start0();
    }

    public void start0() {
        // åº•å±‚é€šè¿‡å¤šçº¿ç¨‹æœºåˆ¶æ¥è°ƒç”¨runæ–¹æ³•
        run();
    }
}
```

#### é‡‡ç”¨çº¿ç¨‹**å†…éƒ¨ç±»**æ–¹å¼

- çœ‹èµ·æ¥æ˜¯newäº†ä¸ªæ¥å£å¯¹è±¡ï¼Œä½†æ˜¯æ¥å£å¹¶ä¸èƒ½newå¯¹è±¡ï¼å®é™…ä¸Šå°±æ˜¯newä¸€ä¸ªåŒ¿åçš„ç±»ï¼Œè¿™ä¸ªç±»æ˜¯å®ç°ç±»æ¥å£çš„

```java
public static void main(String[] args) {
    // åˆ›å»ºçº¿ç¨‹å¯¹è±¡ï¼Œé‡‡ç”¨åŒ¿åå†…éƒ¨ç±»æ–¹å¼ã€‚
    // è¿™æ˜¯é€šè¿‡ä¸€ä¸ªæ²¡æœ‰åå­—çš„ç±»ï¼Œnewå‡ºæ¥çš„å¯¹è±¡ã€‚
    Thread t = new Thread(new Runnable(){
        @Override
        public void run() {
            for(int i = 0; i < 100; i++){
                System.out.println("tçº¿ç¨‹---> " + i);
            }
        }
    });

    // å¯åŠ¨çº¿ç¨‹
    t.start();

    for(int i = 0; i < 100; i++){
        System.out.println("mainçº¿ç¨‹---> " + i);
    }
}

```





#### ç»§æ‰¿å’Œå®ç°ä¸¤ç§æ–¹å¼çš„åŒºåˆ«å’Œé€‰æ‹©

1. é€šè¿‡ç»§æ‰¿Threadæˆ–è€…å®ç°Runnableæ¥å£æ¥åˆ›å»ºçº¿ç¨‹æœ¬è´¨ä¸Šæ²¡æœ‰åŒºåˆ«ï¼ŒThreadç±»æœ¬èº«å°±å®ç°äº†Runnableæ¥å£
2. å®ç°Runnableæ¥å£æ–¹å¼**æ›´åŠ é€‚åˆå¤šä¸ªçº¿ç¨‹å…±äº«ä¸€ä¸ªèµ„æºçš„æƒ…å†µ**ï¼ˆå› ä¸ºä¸€ä¸ªå¯¹è±¡å¯ä»¥ä¼ ç»™å¤šä¸ªçº¿ç¨‹è¿›è¡Œå®ä¾‹åŒ–ï¼‰ï¼Œå¹¶ä¸”é¿å…äº†å•ç»§æ‰¿çš„é™åˆ¶ã€‚å»ºè®®ä½¿ç”¨Runnable

## çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ

![image-20221110115728920](https://s2.loli.net/2023/10/12/gf8yTM4bw5oxHFr.png)

> ç”Ÿå‘½å‘¨æœŸäº”ä¸ªçŠ¶æ€ï¼š**æ–°å»ºã€å°±ç»ªã€è¿è¡Œã€é˜»å¡ã€æ­»äº¡**
>
> - ä¸€ä¸ªæ—¶é—´ç‰‡è¿è¡Œä¸å®Œçš„çº¿ç¨‹ä¼šå›åˆ°å°±ç»ªçŠ¶æ€é‡æ–°æŠ¢å¤ºCPUæ—¶é—´ç‰‡ï¼Œçº¿ç¨‹çš„çŠ¶æ€ä¼šåœ¨**å°±ç»ªå’Œè¿è¡Œé—´æ¥å›åˆ‡æ¢**ï¼Œè¿™ä¸€è¿‡ç¨‹**ç”± JVM è°ƒåº¦**

|   çŠ¶æ€å˜åŒ–   |                         çŠ¶æ€æ”¹å˜äº‹ä»¶                         |
| :----------: | :----------------------------------------------------------: |
|     æ–°å»º     |            çº¿ç¨‹å¯¹è±¡åˆš`new`å‡ºæ¥çš„æ—¶å€™å°±æ˜¯æ–°å»ºçŠ¶æ€             |
| æ–°å»º -> å°±ç»ª |      åœ¨æ‰§è¡Œ`start()`çš„æ—¶å€™çº¿ç¨‹å°±ä»æ–°å»ºå˜ä¸ºå°±ç»ªçŠ¶æ€äº†ã€‚       |
| å°±ç»ª -> è¿è¡Œ | çº¿ç¨‹ä¸æ–­æŠ¢å CUPï¼Œå½“æŠ¢åˆ°çš„æ—¶å€™ï¼Œå°±è¿›å…¥äº†è¿è¡ŒçŠ¶æ€ã€‚åº•å±‚æ‰§è¡Œ`run()`æ–¹æ³•ï¼Œ**`run()`æ–¹æ³•çš„æ‰§è¡Œä¹Ÿä»£è¡¨ç€çº¿ç¨‹è¿›å…¥è¿è¡ŒçŠ¶æ€ã€‚** |
| è¿è¡Œ -> å°±ç»ª | å½“æ—¶é—´ç‰‡ç”¨å®Œæˆ–è€…yield()æ“ä½œæ—¶ï¼Œè¿è¡Œçš„çº¿ç¨‹ä¼šå˜ä¸ºå°±ç»ªçŠ¶æ€ã€‚ä¸‹æ¬¡å†æŠ¢åˆ°æ—¶é—´ç‰‡è¿›å…¥è¿è¡ŒçŠ¶æ€æ—¶ï¼Œä¼šä»ä¸Šä¸€æ¬¡æœ«å°¾æ¥ç€ç»§ç»­æ‰§è¡Œã€‚ |
| è¿è¡Œ -> é˜»å¡ | è¿è¡Œä¸­çš„çº¿ç¨‹**é‡åˆ°äº†`IOæ“ä½œ`æˆ–è€…`sleep()`ç­‰æ“ä½œ**æ—¶ï¼Œä¼šè¿›å…¥é˜»å¡çŠ¶æ€ã€‚æ­¤æ—¶ä¼šæ”¾å¼ƒCPUæ‰§è¡Œæƒå’ŒæŠ¢å åˆ°çš„æ—¶é—´ç‰‡ |
| é˜»å¡ -> å°±ç»ª |           å½“çº¿ç¨‹çš„ç­‰å¾…äº‹ä»¶ç»“æŸä¹‹åï¼Œä¼šè¿›å…¥å°±ç»ªçŠ¶æ€           |
| è¿è¡Œ -> æ­»äº¡ |             å½“`run()`æ–¹æ³•æ‰§è¡Œç»“æŸä¹‹åï¼Œçº¿ç¨‹æ­»äº¡              |





## è·å–å½“å‰çº¿ç¨‹å¯¹è±¡

### ä¸€ã€å¦‚ä½•è·å–å½“å‰çº¿ç¨‹å¯¹è±¡

![image-20220813164450374](https://s2.loli.net/2023/10/12/Ybl1HLTPCVXMEwU.png)

é€šè¿‡`Thread`çš„é™æ€æ–¹æ³•`Thread.currentThread()`å¯ä»¥è·å–ä¸€ä¸ª`Threadå¯¹è±¡`ï¼Œ`Thread.currentThread()`è¿™ä¸ªæ–¹æ³•åœ¨å“ªä¸ªçº¿ç¨‹é‡Œï¼Œè·å–åˆ°çš„çº¿ç¨‹å¯¹è±¡å°±æ˜¯å“ªä¸ªçº¿ç¨‹ã€‚

~~~java
// è¿”å›å€¼tå°±æ˜¯å½“å‰çº¿ç¨‹ã€‚
Thread t = Thread.currentThread();
~~~



### äºŒã€è·å–çº¿ç¨‹å¯¹è±¡åå­—

~~~java
// ç»™ä¸€ä¸ªçº¿ç¨‹å¯¹è±¡è®¾ç½®ï¼ˆä¿®æ”¹ï¼‰åå­—
çº¿ç¨‹å¯¹è±¡.setName("çº¿ç¨‹åå­—");
//è·å–çº¿ç¨‹å¯¹è±¡åå­—
String name = çº¿ç¨‹å¯¹è±¡.getName();
~~~

å¦‚æœæ²¡æœ‰æ‰‹åŠ¨ç»™çº¿ç¨‹å¯¹è±¡ä¸€ä¸ªåå­—çš„è¯ï¼Œçº¿ç¨‹æœ‰è‡ªå·±çš„**é»˜è®¤åå­—**ï¼Œé»˜è®¤åå­—æ˜¯

- Thread-0 
- Thread-1
- Thread-2
- Thread-3
- ç­‰ç­‰
- ==æ³¨ï¼š==ä¸»çº¿ç¨‹çš„é»˜è®¤åå­—æ˜¯`main`



## sleep

### æ¦‚è¿°

![image-20220813165750208](https://s2.loli.net/2023/10/12/MmFXNyltfunWjeO.png)

> `sleep()`æ˜¯ä¸ª**é™æ€æ–¹æ³•**ï¼Œ`Thread.sleep(æ¯«ç§’æ•°);`å‡ºç°åœ¨å“ªä¸ªçº¿ç¨‹é‡Œï¼Œåœ¨æ‰§è¡Œåˆ°è¿™è¡Œçš„æ—¶å€™è¿™ä¸ªçº¿ç¨‹å°±ä¼šä¼‘çœ æŒ‡å®šæ¯«ç§’æ•°



### ==é¢è¯•é¢˜==

> é—®é¢˜ï¼š11è¡Œçš„`t.sleep(1000 * 5);`ä¼šè®©çº¿ç¨‹tè¿›å…¥ç¡çœ çŠ¶æ€å—ï¼Ÿ
>
> ç­”æ¡ˆï¼š==ä¸ä¼š==ï¼Œå› ä¸ºé™æ€æ–¹æ³•å³ä½¿æ˜¯ç”¨å¯¹è±¡å»è°ƒç”¨ï¼Œå®é™…æ‰§è¡Œçš„æ—¶å€™è¿˜æ˜¯ç›¸å½“äº`Thread.sleep(1000 * 5);`ï¼Œå› ä¸ºè¿™è¡Œä»£ç åœ¨`mainçº¿ç¨‹`é‡Œï¼Œæ‰€ä»¥**ä¼šè®©`mainçº¿ç¨‹`ç¡çœ **

```java
public class ThreadTest {
    public static void main(String[] args) {
        // åˆ›å»ºçº¿ç¨‹å¯¹è±¡
        Thread t = new MyThread3();
        t.setName("t");
        t.start();

        // è°ƒç”¨sleepæ–¹æ³•
        try {
            t.sleep(1000 * 5);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }

        // 5ç§’ä¹‹åè¿™é‡Œæ‰ä¼šæ‰§è¡Œã€‚
        System.out.println("hello World!");
    }
}

class MyThread3 extends Thread {
    @Override
    public void run(){
        for(int i = 0; i < 10000; i++){
            System.out.println(Thread.currentThread().getName() + "--->" + i);
        }
    }
}
```



### å«é†’ä¸€ä¸ªç¡çœ çš„çº¿ç¨‹

åœ¨å…¶ä»–çº¿ç¨‹ä¸­ä½¿ç”¨`ç¡çœ çº¿ç¨‹å¯¹è±¡.interrupt();`å¯ä»¥è§¦å‘<u>Javaçš„å¼‚å¸¸å¤„ç†æœºåˆ¶</u>æ¥ä¸­æ–­ç¡çœ çº¿ç¨‹çš„ç¡çœ ã€‚åœ¨ç¡çœ çº¿ç¨‹é‡Œå¯ä»¥ç”¨`try catch`åŒ…ä½`sleep()`è¯­å¥ï¼Œå½“è¢«ä¸­æ–­ä¹‹å`sleep()`è¯­å¥ä¼šæŠ›å¼‚å¸¸ï¼Œç„¶åè¢«catchäº†ä¹‹åå°±ç»§ç»­æ‰§è¡Œäº†ã€‚

> ==æ³¨æ„ï¼š==åœ¨çº¿ç¨‹çš„`run()æ–¹æ³•`é‡Œï¼Œåªèƒ½ç”¨`try catch`ï¼Œè€Œä¸èƒ½åœ¨`runæ–¹æ³•`ä¸Š`throws`å¼‚å¸¸ï¼Œå› ä¸ºç»§æ‰¿äº†çˆ¶ç±»çš„å­ç±»ä¸èƒ½æ¯”çˆ¶ç±»æŠ›å‡ºæ›´å¤šæˆ–è€…æ›´å®½æ³›çš„[å¼‚å¸¸](# å¼‚å¸¸)ã€‚try-catchä¿è¯è¯¥çº¿ç¨‹åœ¨sleepæ—¶è¿˜æ˜¯èƒ½æ„ŸçŸ¥å“åº”ï¼Œèƒ½å¤Ÿå“åº”ä¸­æ–­ï¼Œä¸ä¼šç¡æ­»





## ç»ˆæ­¢çº¿ç¨‹

### å¼ºåˆ¶ç»ˆæ­¢ï¼ˆä¸æ¨èç”¨ï¼Œè¿‡æ—¶ï¼‰

> `çº¿ç¨‹å¯¹è±¡.stop()`
>
> å› ä¸ºæ˜¯ç›´æ¥æ€æ‰çº¿ç¨‹ï¼Œæ²¡ä¿å­˜æ•°æ®ä¼šä¸¢å¤±ï¼Œä¸å®‰å…¨ä¸æ¨èç”¨



### åˆç†ç»ˆæ­¢çº¿ç¨‹

> 1. é€šè¿‡ç»™åœ¨çº¿ç¨‹å†…ç»™å‡ºä¸€ä¸ª`æ ‡è®°`ï¼Œè‹¥æƒ³ç»ˆæ­¢è¿™ä¸ªçº¿ç¨‹ï¼Œåªéœ€è¦ä¿®æ”¹è¿™ä¸ªæ ‡è®°å³å¯ã€‚
> 2. åœ¨çº¿ç¨‹è¿›è¡Œä¸€äº›æ“ä½œå‰å…ˆåˆ¤æ–­è¿™ä¸ªæ ‡è®°ï¼Œå¦‚æœä¸æ˜¯ç»ˆæ­¢çš„è¯å°±æ­£å¸¸æ‰§è¡Œã€‚å¦‚æœæ˜¯ç»ˆæ­¢çš„è¯å¯ä»¥æ‰§è¡Œä¸€äº›ä¿å­˜ç­‰å…¶ä»–çš„æ“ä½œï¼Œä¹‹ååœ¨`return;`å³å¯

```java
public class ThreadTest {
    public static void main(String[] args) {
        MyRunable r = new MyRunable();
        Thread t = new Thread(r);
        t.setName("t");
        t.start();

        // æ¨¡æ‹Ÿ5ç§’
        try {
            Thread.sleep(5000);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        // ç»ˆæ­¢çº¿ç¨‹
        // æƒ³è¦ä»€ä¹ˆæ—¶å€™ç»ˆæ­¢tçš„æ‰§è¡Œï¼Œé‚£ä¹ˆæŠŠæ ‡è®°ä¿®æ”¹ä¸ºfalseï¼Œå°±ç»“æŸäº†ã€‚
        r.run = false;
    }
}

class MyRunable implements Runnable {

    // æ‰“ä¸€ä¸ªå¸ƒå°”æ ‡è®°
    boolean run = true;

    @Override
    public void run() {
        for (int i = 0; i < 10; i++){
            if(run){
                System.out.println(Thread.currentThread().getName() + "--->" + i);
                try {
                    Thread.sleep(1000);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
            }else{
                // returnå°±ç»“æŸäº†ï¼Œåœ¨ç»“æŸä¹‹å‰è¿˜æœ‰ä»€ä¹ˆæ²¡ä¿å­˜çš„ï¼Œåœ¨è¿™é‡Œå¯ä»¥ä¿å­˜
                //save....
                //ç»ˆæ­¢å½“å‰çº¿ç¨‹
                return;
            }
        }
    }
}
```





## çº¿ç¨‹è°ƒåº¦

### å¸¸è§çš„çº¿ç¨‹è°ƒåº¦æ¨¡å‹

1. æŠ¢å å¼è°ƒåº¦æ¨¡å‹ï¼ˆJavaä¸­æ˜¯è¿™ç§æ¨¡å‹ï¼‰
   - å“ªä¸ªçº¿ç¨‹çš„ä¼˜å…ˆçº§æ¯”è¾ƒé«˜ï¼ŒæŠ¢åˆ°çš„CPUæ—¶é—´ç‰‡çš„æ¦‚ç‡å°±é«˜ä¸€äº›/å¤šä¸€äº›ã€‚
2. å‡åˆ†å¼è°ƒåº¦æ¨¡å‹ï¼ˆæœ‰äº›å…¶ä»–è¯­è¨€æ˜¯è¿™ä¸ªï¼‰
   - å¹³å‡åˆ†é…CPUæ—¶é—´ç‰‡ã€‚æ¯ä¸ªçº¿ç¨‹å æœ‰çš„CPUæ—¶é—´ç‰‡æ—¶é—´é•¿åº¦ä¸€æ ·ã€‚



### Javaä¸­å…³äºçº¿ç¨‹è°ƒåº¦çš„æ–¹æ³•

1. `void setPriority(int newPriority)` è®¾ç½®çº¿ç¨‹çš„ä¼˜å…ˆçº§ï¼ˆå®ä¾‹æ–¹æ³•ï¼‰

   - ä¼˜å…ˆçº§æ¯”è¾ƒé«˜çš„è·å–CPUæ—¶é—´ç‰‡å¯èƒ½ä¼šå¤šä¸€äº›ã€‚ï¼ˆä½†ä¹Ÿä¸å®Œå…¨æ˜¯ï¼Œå¤§æ¦‚ç‡æ˜¯å¤šçš„ã€‚ï¼‰

2. `int getPriority()` è·å–çº¿ç¨‹ä¼˜å…ˆçº§ï¼ˆå®ä¾‹æ–¹æ³•ï¼‰

   - **æœ€ä½ä¼˜å…ˆçº§1ï¼Œé»˜è®¤ä¼˜å…ˆçº§æ˜¯5ï¼Œæœ€é«˜ä¼˜å…ˆçº§10**

3. `void join()` åˆå¹¶çº¿ç¨‹ï¼ˆæ’é˜Ÿï¼‰ï¼ˆå®ä¾‹æ–¹æ³•ï¼‰

   - åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­å†™`å¦ä¸€ä¸ªçº¿ç¨‹çš„å¯¹è±¡.join();`çš„æ„æ€æ˜¯ï¼šå½“å‰çº¿ç¨‹**é˜»å¡**ï¼Œè®©é‚£ä¸ªçº¿ç¨‹æ¥å…ˆæ‰§è¡Œï¼Œæ‰§è¡Œç»“æŸä¹‹åå½“å‰çº¿ç¨‹æ‰ç»§ç»­

   - ```java
     class MyThread1 extends Thread {
         public void doSome(){
             MyThread2 t = new MyThread2();
             t.join(); // å½“å‰çº¿ç¨‹è¿›å…¥é˜»å¡ï¼Œtçº¿ç¨‹æ‰§è¡Œï¼Œç›´åˆ°tçº¿ç¨‹ç»“æŸã€‚å½“å‰çº¿ç¨‹æ‰å¯ä»¥ç»§ç»­ã€‚
         }
     }
     
     class MyThread2 extends Thread{
     
     }
     ```

4. `static void yield() ` è®©ä½æ–¹æ³•ï¼ˆçœ‹èµ·æ¥è®©äº†ï¼Œä½†æ˜¯æ²¡å®Œå…¨è®©ï¼‰ï¼ˆé™æ€æ–¹æ³•ï¼‰

   - å½“æ‰§è¡Œåˆ°`yield()æ–¹æ³•`æ—¶ï¼Œå…¶æ‰€åœ¨çš„çº¿ç¨‹ä¼šä»**â€œè¿è¡ŒçŠ¶æ€â€å›åˆ°â€œå°±ç»ªçŠ¶æ€â€**
   - æ³¨æ„ï¼šè¿™å¹¶ä¸æ˜¯é˜»å¡ï¼Œåªæ˜¯**æš‚æ—¶**çš„è®©ä½ï¼Œåˆ°å°±ç»ªä¹‹åè¿˜**å¯èƒ½å†æ¬¡æŠ¢åˆ°**

5. `void interrupt()`

   - é€šè¿‡`çº¿ç¨‹å¯¹è±¡.interrupt()`å¯ä»¥ä»å¤–éƒ¨ä¸­æ–­è¿™ä¸ªçº¿ç¨‹çš„ä¼‘çœ ï¼ˆ[å”¤é†’](# å«é†’ä¸€ä¸ªç¡çœ çš„çº¿ç¨‹)ï¼‰






## :star::star: å¤šçº¿ç¨‹é‡ç‚¹ï¼šçº¿ç¨‹å®‰å…¨

### ä¸€ã€ä»€ä¹ˆæƒ…å†µä¸‹å¤šçº¿ç¨‹å¹¶å‘ä¼šæœ‰å®‰å…¨é—®é¢˜ï¼Ÿ

æ»¡è¶³ä»¥ä¸‹ä¸‰ä¸ªæ¡ä»¶çš„å°±ä¼šå­˜åœ¨å®‰å…¨é—®é¢˜

1. æ¡ä»¶1ï¼šå¤šçº¿ç¨‹å¹¶å‘ã€‚
2. æ¡ä»¶2ï¼šæœ‰å…±äº«æ•°æ®ã€‚
3. æ¡ä»¶3ï¼šå…±äº«æ•°æ®æœ‰ä¿®æ”¹çš„è¡Œä¸ºã€‚



### äºŒã€çº¿ç¨‹åŒæ­¥æœºåˆ¶

**ä¸è®©å¹¶å‘**ï¼ˆè®©çº¿ç¨‹æ’é˜Ÿæ‰§è¡Œï¼‰ï¼Œé€šè¿‡æ’é˜Ÿæ‰§è¡Œæ¥è§£å†³ç§°ä¸ºï¼š`çº¿ç¨‹åŒæ­¥`ï¼Œè¿™ç§æœºåˆ¶ç§°ä¸ºçº¿ç¨‹åŒæ­¥æœºåˆ¶



### ä¸‰ã€åŒæ­¥å¼‚æ­¥æ¦‚å¿µ

1. å¼‚æ­¥ç¼–ç¨‹æ¨¡å‹ï¼š
   çº¿ç¨‹t1å’Œçº¿ç¨‹t2ï¼Œ**å„è‡ªæ‰§è¡Œå„è‡ªçš„**ï¼Œt1ä¸ç®¡t2ï¼Œt2ä¸ç®¡t1ï¼Œ**è°ä¹Ÿä¸éœ€è¦ç­‰è°**ï¼Œè¿™ç§ç¼–ç¨‹æ¨¡å‹å«åšï¼šå¼‚æ­¥ç¼–ç¨‹æ¨¡å‹ã€‚å…¶å®å°±æ˜¯ï¼šå¤šçº¿ç¨‹å¹¶å‘ï¼ˆæ•ˆç‡è¾ƒé«˜ã€‚ï¼‰***å¼‚æ­¥å°±æ˜¯å¹¶å‘***ã€‚
2. åŒæ­¥ç¼–ç¨‹æ¨¡å‹ï¼š
   çº¿ç¨‹t1å’Œçº¿ç¨‹t2ï¼Œåœ¨çº¿ç¨‹t1æ‰§è¡Œçš„æ—¶å€™ï¼Œå¿…é¡»ç­‰å¾…t2çº¿ç¨‹æ‰§è¡Œç»“æŸï¼Œæˆ–è€…è¯´åœ¨t2çº¿ç¨‹æ‰§è¡Œçš„æ—¶å€™ï¼Œå¿…é¡»ç­‰å¾…t1çº¿ç¨‹æ‰§è¡Œç»“æŸï¼Œ<u>ä¸¤ä¸ªçº¿ç¨‹ä¹‹é—´å‘ç”Ÿäº†ç­‰å¾…å…³ç³»</u>ï¼Œè¿™å°±æ˜¯åŒæ­¥ç¼–ç¨‹æ¨¡å‹ã€‚æ•ˆç‡è¾ƒä½ã€‚çº¿ç¨‹æ’é˜Ÿæ‰§è¡Œã€‚***åŒæ­¥å°±æ˜¯æ’é˜Ÿ***ã€‚





### å››ã€:star:è§£å†³çº¿ç¨‹å®‰å…¨

~~~java
synchronized (éœ€è¦åŒæ­¥çš„çº¿ç¨‹æ‰€å…±äº«çš„å¯¹è±¡) { 
	éœ€è¦çº¿ç¨‹åŒæ­¥æ¥ä¿æŠ¤çš„æ“ä½œï¼Œçº¿ç¨‹åŒæ­¥ä»£ç å—ã€‚
}
~~~

> ==åœ¨`synchronized(å¯¹è±¡)`æ‹¬å·ä¸­çš„â€œå¯¹è±¡â€ï¼Œæ˜¯éœ€è¦åŒæ­¥çš„çº¿ç¨‹æ‰€å…±äº«çš„==
>
> å‡è®¾å†™çš„æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œåœ¨å­—ç¬¦ä¸²å¸¸é‡æ± é‡Œåªæœ‰ä¸€ä¸ªï¼Œé‚£æ‰€æœ‰çº¿ç¨‹æ‰§è¡Œåˆ°è¿™éƒ½ä¼šåŒæ­¥

> **å¯¹è±¡é”æ¦‚å¿µ**ï¼šåœ¨Javaè¯­è¨€ä¸­ï¼Œä»»ä½•ä¸€ä¸ªå¯¹è±¡éƒ½æœ‰â€œä¸€æŠŠé”â€ï¼Œå…¶å®è¿™æŠŠé”å°±æ˜¯æ ‡è®°ã€‚ï¼ˆåªæ˜¯æŠŠå®ƒå«åšé”ï¼‰ï¼Œ100ä¸ªå¯¹è±¡ï¼Œ100æŠŠé”ã€‚1ä¸ªå¯¹è±¡1æŠŠé”ã€‚

æ‰§è¡Œæµç¨‹

1. çº¿ç¨‹é‡åˆ°`synchronized`ï¼Œç«‹é©¬**ä»â€œè¿è¡ŒçŠ¶æ€â€è¿›å…¥â€œé”æ± â€**ï¼ˆlockpoolï¼‰ï¼Œæ­¤æ—¶çº¿ç¨‹ä¼šæ”¾å¼ƒå æœ‰çš„CPUæ—¶é—´ç‰‡ã€‚ï¼ˆå¯ä»¥ç†è§£ä¸ºä¸€ç§**é˜»å¡**çŠ¶æ€ï¼‰
2. çº¿ç¨‹åœ¨é”æ± é‡Œæ‰¾`synchronized(å¯¹è±¡)`æ‹¬å·ä¸­çš„â€œå¯¹è±¡â€çš„å¯¹è±¡é”
   - å¦‚æœæ‰¾åˆ°äº†ï¼Œå°±è¿›å…¥å°±ç»ªçŠ¶æ€ç»§ç»­æŠ¢å¤ºCPUæ—¶é—´ç‰‡
   - å¦‚æœæ²¡æŠ¢åˆ°ï¼Œå°±ä¸€ç›´åœ¨é”æ± ä¸­ç­‰å¾…
3. å½“ä¸€ä¸ªå æœ‰å¯¹è±¡é”çš„çº¿ç¨‹æ‰§è¡Œå®ŒåŒæ­¥ä»£ç å—ä»£ç ä¹‹åï¼Œä¼šé‡Šæ”¾é”





### äº”ã€:star:å®ä¾‹å˜é‡ã€å±€éƒ¨å˜é‡ã€é™æ€å˜é‡å¯¹çº¿ç¨‹åŒæ­¥çš„å½±å“

#### Javaä¸­çš„ä¸‰å¤§å˜é‡ï¼š

1. å®ä¾‹å˜é‡ï¼šåœ¨å †ä¸­ã€‚

2. é™æ€å˜é‡ï¼šåœ¨æ–¹æ³•åŒºã€‚

3. å±€éƒ¨å˜é‡ï¼šåœ¨æ ˆä¸­




- åœ¨è¿™äº›å˜é‡ä¸­**ï¼Œå±€éƒ¨å˜é‡æ°¸è¿œéƒ½ä¸ä¼šå­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜**ã€‚	å› ä¸ºå±€éƒ¨å˜é‡ä¸å…±äº«ã€‚ï¼ˆä¸€ä¸ªçº¿ç¨‹ä¸€ä¸ªæ ˆï¼‰ï¼Œ	å±€éƒ¨å˜é‡åœ¨æ ˆä¸­ã€‚æ‰€ä»¥å±€éƒ¨å˜é‡æ°¸è¿œéƒ½ä¸ä¼šå…±äº«ã€‚

- å®ä¾‹å˜é‡åœ¨å †ä¸­ï¼Œå †åªæœ‰1ä¸ªã€‚é™æ€å˜é‡åœ¨æ–¹æ³•åŒºä¸­ï¼Œæ–¹æ³•åŒºåªæœ‰1ä¸ªã€‚å †å’Œæ–¹æ³•åŒºéƒ½æ˜¯å¤šçº¿ç¨‹å…±äº«çš„ï¼Œæ‰€ä»¥å¯èƒ½å­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚

   

#### **æ€»ç»“**

**å±€éƒ¨å˜é‡ / å¸¸é‡ï¼šä¸ä¼šæœ‰çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚**
**æˆå‘˜å˜é‡ï¼šå¯èƒ½ä¼šæœ‰çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚**



#### å¦‚æœä½¿ç”¨å±€éƒ¨å˜é‡çš„è¯ï¼š

1. `StringBuffer`æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œæ•ˆç‡ä½ï¼Œ`StringBuilder`æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œæ•ˆç‡é«˜ã€‚**é€‰`StringBuffer`**ï¼Œå› ä¸ºå±€éƒ¨å˜é‡ä¸å­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚é€‰æ‹©`StringBuilder`ã€‚`StringBuffer`æ•ˆç‡æ¯”è¾ƒä½ã€‚

**æ‹“å±•**

1. ArrayListæ˜¯éçº¿ç¨‹å®‰å…¨çš„ã€‚
2. Vectoræ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚
3. HashMap HashSetæ˜¯éçº¿ç¨‹å®‰å…¨çš„ã€‚
4. Hashtableæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚



### å…­ã€synchronizedæœ‰ä¸‰ç§å†™æ³•

#### ç¬¬ä¸€ç§ï¼šåŒæ­¥ä»£ç å—ï¼ˆçµæ´»ï¼‰

```java
synchronized(çº¿ç¨‹å…±äº«å¯¹è±¡){
    åŒæ­¥ä»£ç å—;
}
```

#### ç¬¬äºŒç§ï¼šåœ¨å®ä¾‹æ–¹æ³•ä¸Šä½¿ç”¨synchronized

> `synchronized`å‡ºç°åœ¨å®ä¾‹æ–¹æ³•ä¸Šï¼Œ<font size=6>**ä¸€å®šé”çš„æ˜¯`this`**</font>
>
> å¦‚æœå…±äº«çš„å¯¹è±¡å°±æ˜¯`this`ï¼Œå¹¶ä¸”éœ€è¦åŒæ­¥çš„ä»£ç å—æ˜¯æ•´ä¸ªæ–¹æ³•ä½“ï¼Œå»ºè®®ä½¿ç”¨è¿™ç§æ–¹å¼ã€‚ï¼ˆæºç é‡Œå¾ˆå¤šç”¨è¿™ç§æ–¹å¼çš„ï¼‰

**ç¼ºç‚¹ï¼š**

1. ç¼ºç‚¹1ï¼šå› ä¸º**åªèƒ½é”`this`**ï¼Œä¸”ä¸èƒ½æ˜¯å…¶ä»–å¯¹è±¡ï¼Œæ‰€ä»¥è¿™ç§æ–¹å¼ä¸çµæ´»
2. ç¼ºç‚¹2ï¼š`synchronized`å‡ºç°åœ¨å®ä¾‹æ–¹æ³•ä¸Šè¡¨ç¤ºæ•´ä¸ªæ–¹æ³•ä½“éƒ½éœ€è¦åŒæ­¥ï¼Œå¯èƒ½ä¼šæ— æ•…æ‰©å¤§åŒæ­¥çš„èŒƒå›´ï¼Œå¯¼è‡´ç¨‹åºçš„æ‰§è¡Œ**æ•ˆç‡é™ä½**ã€‚æ‰€ä»¥è¿™ç§æ–¹å¼ä¸å¸¸ç”¨ã€‚

**ä¼˜ç‚¹ï¼š**

1. ä»£ç ç²¾ç®€



#### ç¬¬ä¸‰ç§ï¼šåœ¨é™æ€æ–¹æ³•ä¸Šä½¿ç”¨synchronized

> è¡¨ç¤ºæ‰¾ç±»é”ã€‚==ç±»é”æ°¸è¿œåªæœ‰1æŠŠ==ã€‚å°±ç®—åˆ›å»ºäº†100ä¸ªå¯¹è±¡ï¼Œé‚£ç±»é”ä¹Ÿåªæœ‰ä¸€æŠŠã€‚
>
> ==ç±»é”å¯ä»¥ç”¨äºä¿è¯é™æ€å˜é‡çš„å®‰å…¨==
>
> å¯¹è±¡é”ï¼š1ä¸ªå¯¹è±¡1æŠŠé”ï¼Œ100ä¸ªå¯¹è±¡100æŠŠé”ã€‚
>
> ç±»é”ï¼š100ä¸ªå¯¹è±¡ï¼Œä¹Ÿå¯èƒ½åªæ˜¯1æŠŠç±»é”ã€‚



### ==**é¢è¯•é¢˜**==

#### ä¸€ã€`synchronized`åœ¨å…¶ä»–æ–¹æ³•ä¸Š

> å› ä¸º`doOther()æ–¹æ³•`æ²¡æœ‰`synchronized`ï¼Œæ‰€ä»¥`t2`åœ¨è¿›è¡Œ**`doOther()æ–¹æ³•`çš„æ—¶å€™æ²¡æœ‰å»è·å–é”**ï¼Œæ‰€ä»¥æ²¡æœ‰ç­‰å¾…`t1`
>
> å¦‚æœ`doOther()æ–¹æ³•`æœ‰`synchronized`çš„è¯ï¼Œé‚£ä¹ˆ`t2`åœ¨è¿›è¡Œ`doOther()æ–¹æ³•`çš„æ—¶å€™å°±ä¼šè·å–é”ï¼Œå› ä¸º`t1`å äº†ï¼Œæ‰€ä»¥ä¼šç­‰å¾…`t1`

```java
// é¢è¯•é¢˜ï¼šdoOtheræ–¹æ³•æ‰§è¡Œçš„æ—¶å€™éœ€è¦ç­‰å¾…doSomeæ–¹æ³•çš„ç»“æŸå—ï¼Ÿ
//ä¸éœ€è¦ï¼Œå› ä¸ºdoOther()æ–¹æ³•æ²¡æœ‰synchronized
public class Exam01 {
    public static void main(String[] args) throws InterruptedException {
        MyClass mc = new MyClass();

        Thread t1 = new MyThread(mc);
        Thread t2 = new MyThread(mc);

        t1.setName("t1");
        t2.setName("t2");

        t1.start();
        Thread.sleep(1000); //è¿™ä¸ªç¡çœ çš„ä½œç”¨æ˜¯ï¼šä¸ºäº†ä¿è¯t1çº¿ç¨‹å…ˆæ‰§è¡Œã€‚
        t2.start();
    }
}

class MyThread extends Thread {
    private MyClass mc;
    public MyThread(MyClass mc){
        this.mc = mc;
    }
    public void run(){
        if(Thread.currentThread().getName().equals("t1")){
            mc.doSome();
        }
        if(Thread.currentThread().getName().equals("t2")){
            mc.doOther();
        }
    }
}

class MyClass {
    public synchronized void doSome(){
        System.out.println("doSome begin");
        try {
            Thread.sleep(1000 * 10);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        System.out.println("doSome over");
    }
    public void doOther(){
        System.out.println("doOther begin");
        System.out.println("doOther over");
    }
}
```



#### äºŒã€ä¸¤ä¸ªå¯¹è±¡è¿›ä¸¤ä¸ª`synchronized`é”çš„æ–¹æ³•

```java
// é¢è¯•é¢˜ï¼šdoOtheræ–¹æ³•æ‰§è¡Œçš„æ—¶å€™éœ€è¦ç­‰å¾…doSomeæ–¹æ³•çš„ç»“æŸå—ï¼Ÿ
//ä¸éœ€è¦ï¼Œå› ä¸ºMyClasså¯¹è±¡æ˜¯ä¸¤ä¸ªï¼Œä¸¤æŠŠé”ã€‚
public class Exam01 {
    public static void main(String[] args) throws InterruptedException {
        MyClass mc1 = new MyClass();
        MyClass mc2 = new MyClass();

        Thread t1 = new MyThread(mc1);
        Thread t2 = new MyThread(mc2);

        t1.setName("t1");
        t2.setName("t2");

        t1.start();
        Thread.sleep(1000); //è¿™ä¸ªç¡çœ çš„ä½œç”¨æ˜¯ï¼šä¸ºäº†ä¿è¯t1çº¿ç¨‹å…ˆæ‰§è¡Œã€‚
        t2.start();
    }
}

class MyThread extends Thread {
    private MyClass mc;
    public MyThread(MyClass mc){
        this.mc = mc;
    }
    public void run(){
        if(Thread.currentThread().getName().equals("t1")){
            mc.doSome();
        }
        if(Thread.currentThread().getName().equals("t2")){
            mc.doOther();
        }
    }
}

class MyClass {
    public synchronized void doSome(){
        System.out.println("doSome begin");
        try {
            Thread.sleep(1000 * 10);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        System.out.println("doSome over");
    }
    public synchronized void doOther(){
        System.out.println("doOther begin");
        System.out.println("doOther over");
    }
}
```





#### ä¸‰ã€`synchronized`åœ¨é™æ€æ–¹æ³•ä¸Š

> ==`synchronized`åœ¨é™æ€æ–¹æ³•ä¸Šæ˜¯ç±»é”==ï¼ŒåŒä¸€ä¸ªç±»çš„æ‰€æœ‰å¯¹è±¡éƒ½åªæœ‰**ä¸€æŠŠ`ç±»é”`**

```java
// é¢è¯•é¢˜ï¼šdoOtheræ–¹æ³•æ‰§è¡Œçš„æ—¶å€™éœ€è¦ç­‰å¾…doSomeæ–¹æ³•çš„ç»“æŸå—ï¼Ÿ
//éœ€è¦ï¼Œå› ä¸ºé™æ€æ–¹æ³•æ˜¯ç±»é”ï¼Œä¸ç®¡åˆ›å»ºäº†å‡ ä¸ªå¯¹è±¡ï¼Œç±»é”åªæœ‰1æŠŠã€‚
public class Exam01 {
    public static void main(String[] args) throws InterruptedException {
        MyClass mc1 = new MyClass();
        MyClass mc2 = new MyClass();

        Thread t1 = new MyThread(mc1);
        Thread t2 = new MyThread(mc2);

        t1.setName("t1");
        t2.setName("t2");

        t1.start();
        Thread.sleep(1000); //è¿™ä¸ªç¡çœ çš„ä½œç”¨æ˜¯ï¼šä¸ºäº†ä¿è¯t1çº¿ç¨‹å…ˆæ‰§è¡Œã€‚
        t2.start();
    }
}

class MyThread extends Thread {
    private MyClass mc;
    public MyThread(MyClass mc){
        this.mc = mc;
    }
    public void run(){
        if(Thread.currentThread().getName().equals("t1")){
            mc.doSome();
        }
        if(Thread.currentThread().getName().equals("t2")){
            mc.doOther();
        }
    }
}

class MyClass {
    // synchronizedå‡ºç°åœ¨é™æ€æ–¹æ³•ä¸Šæ˜¯æ‰¾ç±»é”ã€‚
    public synchronized static void doSome(){
        System.out.println("doSome begin");
        try {
            Thread.sleep(1000 * 10);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        System.out.println("doSome over");
    }
    public synchronized static void doOther(){
        System.out.println("doOther begin");
        System.out.println("doOther over");
    }
}
```





### ä¸ƒã€æ­»é”

#### å†™æ³•1ï¼šå®ç°Runnable

> åŸå› ï¼šåµŒå¥—çš„`synchronized`å¯¼è‡´ä¸¤ä¸ªçº¿ç¨‹äº’ç›¸ç­‰å¾…
>
> æ­»é”çš„ä»£ç è¦ä¼šå†™ï¼Œ

```java
package com.bjpowernode.java.deadlock;

import com.bjpowernode.java.threadsafe3.T;

/**
 * @author å°ç«å¨ƒ
 * @project_name: javase
 * @package_name: com.xiaohuowa.java.deadlock
 */
public class MyDeadLockTest {
    public static void main(String[] args) {
        Object o1 = new Object();
        Object o2 = new Object();

        Thread t1 = new Thread(new Dead(o1, o2));
        Thread t2 = new Thread(new Dead2(o1, o2));
        t1.start();
        t2.start();
    }

}

class Dead implements Runnable {
    Object o1 = null;
    Object o2 = null;

    public Dead(Object o1, Object o2) {
        this.o1 = o1;
        this.o2 = o2;
    }

    @Override
    public void run() {
        synchronized (o1) {
            try {
                Thread.sleep(1000);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
            synchronized (o2) {

            }
        }
    }

}
class Dead2 implements Runnable {
    Object o1 = null;
    Object o2 = null;

    public Dead2(Object o1, Object o2) {
        this.o1 = o1;
        this.o2 = o2;
    }

    @Override
    public void run() {
        synchronized (o2) {
            try {
                Thread.sleep(1000);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
            synchronized (o1) {

            }
        }
    }

}
```





#### å†™æ³•2ï¼šç»§æ‰¿Thread

```java
package com.xiaohuowa.mythread.dead;

/**
 * @author å°ç«å¨ƒ
 * @project_name: my_projects
 * @package_name: com.xiaohuowa.mythread.dead
 */
public class ThreadDeadLock {
    public static void main(String[] args) {
        Thread thread1 = new Thread(new DeadLock(true));
        Thread thread2 = new Thread(new DeadLock(false));
        thread1.start();
        thread2.start();
    }
}

class DeadLock extends Thread{
    static Object o1 = new Object();
    static Object o2 = new Object();

    private boolean lock;

    public DeadLock(boolean lock) {
        this.lock = lock;
    }

    @Override
    public void run() {

        if (lock) {
            // ä¸€ä¸ªçº¿ç¨‹è¿›æ¥å…ˆæ‹¿o1å¯¹è±¡é”
            synchronized (o1) {
                System.out.println(Thread.currentThread().getName() + "è·å–åˆ°o1å¯¹è±¡é”");
                // ä¹‹åè¯·æ±‚o2å¯¹è±¡é”ï¼Œæ²¡æ‹¿åˆ°å°±blocked
                synchronized (o2) {
                    System.out.println(Thread.currentThread().getName() + "è·å–åˆ°o2å¯¹è±¡é”");
                }
            }
        } else {
            // è¯·æ±‚o2å¯¹è±¡é”ï¼Œæ²¡æ‹¿åˆ°å°±blocked
            synchronized (o2) {
                System.out.println(Thread.currentThread().getName() + "è·å–åˆ°o2å¯¹è±¡é”");
                synchronized (o1){
                    System.out.println(Thread.currentThread().getName() + "è·å–åˆ°o1å¯¹è±¡é”");
                }
            }
        }

    }
}
```







### å…«ã€å¼€å‘ä¸­åº”è¯¥æ€ä¹ˆè§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜

==æ³¨æ„ï¼š==ä¸æ˜¯ä¸€ä¸Šæ¥å°±é€‰æ‹©çº¿ç¨‹åŒæ­¥å—ï¼Œ`synchronized`ä¼šè®©ç¨‹åºçš„æ‰§è¡Œæ•ˆç‡é™ä½ï¼Œç”¨æˆ·ä½“éªŒä¸å¥½ã€‚ç³»ç»Ÿçš„ç”¨æˆ·ååé‡é™ä½ã€‚ç”¨æˆ·ä½“éªŒå·®ã€‚åœ¨ä¸å¾—å·²çš„æƒ…å†µä¸‹å†é€‰æ‹©çº¿ç¨‹åŒæ­¥æœºåˆ¶ã€‚

1. **ï¼ˆä¼˜å…ˆï¼‰**ç¬¬ä¸€ç§æ–¹æ¡ˆï¼šå°½é‡ä½¿ç”¨`å±€éƒ¨å˜é‡ä»£æ›¿â€œå®ä¾‹å˜é‡å’Œé™æ€å˜é‡â€`ã€‚
2. **ï¼ˆå…¶æ¬¡ï¼‰**ç¬¬äºŒç§æ–¹æ¡ˆï¼šå¦‚æœå¿…é¡»æ˜¯å®ä¾‹å˜é‡ï¼Œé‚£ä¹ˆå¯ä»¥è€ƒè™‘**åˆ›å»ºå¤šä¸ªå¯¹è±¡**ï¼Œè¿™æ ·å®ä¾‹å˜é‡çš„å†…å­˜å°±ä¸å…±äº«äº†ã€‚ï¼ˆä¸€ä¸ªçº¿ç¨‹å¯¹åº”1ä¸ªå¯¹è±¡ï¼Œ100ä¸ªçº¿ç¨‹å¯¹åº”100ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡ä¸å…±äº«ï¼Œå°±æ²¡æœ‰æ•°æ®å®‰å…¨é—®é¢˜äº†ã€‚ï¼‰
3. **ï¼ˆå®åœ¨ä¸è¡Œï¼‰**ç¬¬ä¸‰ç§æ–¹æ¡ˆï¼šå¦‚æœä¸èƒ½ä½¿ç”¨å±€éƒ¨å˜é‡ï¼Œå¯¹è±¡ä¹Ÿä¸èƒ½åˆ›å»ºå¤šä¸ªï¼Œè¿™ä¸ªæ—¶å€™å°±åªèƒ½é€‰æ‹©`synchronized`çº¿ç¨‹åŒæ­¥æœºåˆ¶ã€‚





### ä¹ã€å…¶ä»–çŸ¥è¯†ç‚¹

#### ä¸€ã€å®ˆæŠ¤çº¿ç¨‹

##### **javaè¯­è¨€ä¸­çº¿ç¨‹åˆ†ä¸ºä¸¤å¤§ç±»ï¼š**

1. ä¸€ç±»æ˜¯ï¼šç”¨æˆ·çº¿ç¨‹
2. ä¸€ç±»æ˜¯ï¼šå®ˆæŠ¤çº¿ç¨‹ï¼ˆåå°çº¿ç¨‹ï¼‰
   - å…¶ä¸­å…·æœ‰ä»£è¡¨æ€§çš„å°±æ˜¯ï¼šåƒåœ¾å›æ”¶çº¿ç¨‹ï¼ˆå®ˆæŠ¤çº¿ç¨‹ï¼‰ã€‚



##### å®ˆæŠ¤çº¿ç¨‹çš„ç‰¹ç‚¹

ä¸€èˆ¬å®ˆæŠ¤çº¿ç¨‹æ˜¯ä¸€ä¸ªæ­»å¾ªç¯ï¼Œæ‰€æœ‰çš„ç”¨æˆ·çº¿ç¨‹åªè¦ç»“æŸï¼Œå®ˆæŠ¤çº¿ç¨‹è‡ªåŠ¨ç»“æŸã€‚

æ³¨æ„ï¼š`ä¸»çº¿ç¨‹mainæ–¹æ³•æ˜¯ä¸€ä¸ªç”¨æˆ·çº¿ç¨‹`



##### å®ˆæŠ¤çº¿ç¨‹ç”¨åœ¨ä»€ä¹ˆåœ°æ–¹å‘¢ï¼Ÿ

æ¯”å¦‚ä¸€ä¸ªè½¯ä»¶éœ€è¦æ¯å¤©åœ¨å›ºå®šæ—¶é—´è·³å‡ºæ¥ä¸€ä¸‹ï¼Œå°±éœ€è¦ç”¨åˆ°å®šæ—¶å™¨ï¼Œå°†å…¶è®¾ç½®ä¸ºå®ˆæŠ¤çº¿ç¨‹ï¼Œç­‰åˆ°ç‚¹äº†å°±è·³ä¸€ä¸‹ã€‚å¦‚æœç¨‹åºé€€å‡ºäº†ï¼ˆç”¨æˆ·çº¿ç¨‹ç»“æŸäº†ï¼‰ï¼Œé‚£ä¹ˆå®ˆæŠ¤çº¿ç¨‹ä¹Ÿè‡ªåŠ¨é€€å‡ºã€‚



##### è®¾ç½®å®ˆæŠ¤çº¿ç¨‹

> `çº¿ç¨‹å¯¹è±¡.setDaemon(true);`**å¯åŠ¨çº¿ç¨‹ä¹‹å‰**ï¼Œå°†`setDaemon`ç»™ä¸ª`true`ï¼Œå³å¯è®¾ç½®çº¿ç¨‹ä¸ºå®ˆæŠ¤çº¿ç¨‹

![image-20220814174235551](https://s2.loli.net/2023/10/12/9MFHTdlgUu2WAk7.png)



#### äºŒã€å®šæ—¶å™¨-Timer

![image-20220814181246357](https://s2.loli.net/2023/10/12/otRsdAVQP95fKag.png)

##### ä½œç”¨

é—´éš”ç‰¹å®šçš„æ—¶é—´ï¼Œæ‰§è¡Œç‰¹å®šçš„ç¨‹åºã€‚



##### åŸå§‹å®šæ—¶å™¨

å¯ä»¥ä½¿ç”¨`sleepæ–¹æ³•`ï¼Œç¡çœ ï¼Œè®¾ç½®ç¡çœ æ—¶é—´ï¼Œæ²¡åˆ°è¿™ä¸ªæ—¶é—´ç‚¹é†’æ¥ï¼Œæ‰§è¡Œä»»åŠ¡ã€‚è¿™ç§æ–¹å¼æ˜¯æœ€åŸå§‹çš„å®šæ—¶å™¨ã€‚



##### ä¸é‚£ä¹ˆåŸå§‹çš„å®šæ—¶å™¨

åœ¨Javaçš„ç±»åº“ä¸­å·²ç»å†™å¥½äº†ä¸€ä¸ªå®šæ—¶å™¨ï¼š`java.util.Timer`ï¼Œå¯ä»¥ç›´æ¥æ‹¿æ¥ç”¨ã€‚ä¸è¿‡ï¼Œè¿™ç§æ–¹å¼åœ¨ç›®å‰çš„å¼€å‘ä¸­ä¹Ÿå¾ˆå°‘ç”¨ï¼Œå› ä¸ºç°åœ¨æœ‰å¾ˆå¤šé«˜çº§æ¡†æ¶éƒ½æ˜¯æ”¯æŒå®šæ—¶ä»»åŠ¡çš„ã€‚

æ¯”å¦‚Springçš„`SpringTaskæ¡†æ¶`ã€‚ä½†æ˜¯åº•å±‚å®ç°ä¹Ÿæ˜¯é `java.util.Timer`


â€‹	

##### ç¤ºä¾‹

```java
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.Timer;
import java.util.TimerTask;

/*
	ä½¿ç”¨å®šæ—¶å™¨æŒ‡å®šå®šæ—¶ä»»åŠ¡ã€‚
 */
public class TimerTest {
    public static void main(String[] args) throws Exception {

        // åˆ›å»ºå®šæ—¶å™¨å¯¹è±¡
        Timer timer = new Timer();
        //Timer timer = new Timer(true); //å®ˆæŠ¤çº¿ç¨‹çš„æ–¹å¼

        // æŒ‡å®šå®šæ—¶ä»»åŠ¡
        //timer.schedule(å®šæ—¶ä»»åŠ¡, ç¬¬ä¸€æ¬¡æ‰§è¡Œæ—¶é—´, é—´éš”å¤šä¹…æ‰§è¡Œä¸€æ¬¡);
        SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
        Date firstTime = sdf.parse("2020-03-14 09:34:30");
        // åç§’ä¸€æ¬¡
        //timer.schedule(new LogTimerTask() , firstTime, 1000 * 10); 
        // æ¯å¹´æ‰§è¡Œä¸€æ¬¡ã€‚
        //timer.schedule(new LogTimerTask() , firstTime, 1000 * 60 * 60 * 24 * 365);

        //åŒ¿åå†…éƒ¨ç±»æ–¹å¼
        timer.schedule(new TimerTask(){
            @Override
            public void run() {
                // code....
            }
        } , firstTime, 1000 * 10);  // åç§’ä¸€æ¬¡

    }
}

// ç¼–å†™ä¸€ä¸ªå®šæ—¶ä»»åŠ¡ç±»
// å‡è®¾è¿™æ˜¯ä¸€ä¸ªè®°å½•æ—¥å¿—çš„å®šæ—¶ä»»åŠ¡
class LogTimerTask extends TimerTask {

    @Override
    public void run() {
        // ç¼–å†™éœ€è¦æ‰§è¡Œçš„ä»»åŠ¡å°±è¡Œäº†ã€‚
        SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
        String strTime = sdf.format(new Date());
        System.out.println(strTime + ":æˆåŠŸå®Œæˆäº†ä¸€æ¬¡æ•°æ®å¤‡ä»½ï¼");
    }
}
```





#### ä¸‰ã€ç¬¬ä¸‰ç§çº¿ç¨‹å†™æ³•

> é€šè¿‡å®ç°`Callableæ¥å£`çš„ç±»ï¼Œé‡Œé¢çš„`call()`ç›¸å½“äºåŸæ¥çš„`run()æ–¹æ³•`ï¼Œä½†æ˜¯å®ƒ**å¯ä»¥æœ‰è¿”å›å€¼ä¸”å¯ä»¥throwså¼‚å¸¸**ã€‚ç”¨`æœªæ¥ä»»åŠ¡å¯¹è±¡.get()`å¯ä»¥å¾—åˆ°çº¿ç¨‹çš„è¿”å›å€¼ã€‚`get()`çš„å‡ºç°ä¼šå¯¼è‡´å½“å‰çº¿ç¨‹çš„**é˜»å¡**ï¼ˆè¦ç­‰getåˆ°æ‰èƒ½ç»§ç»­æ‰§è¡Œï¼‰

```java
import java.util.concurrent.Callable;
import java.util.concurrent.FutureTask; // JUCåŒ…ä¸‹çš„ï¼Œå±äºjavaçš„å¹¶å‘åŒ…ï¼Œè€JDKä¸­æ²¡æœ‰è¿™ä¸ªåŒ…ã€‚æ–°ç‰¹æ€§ã€‚

/*
å®ç°çº¿ç¨‹çš„ç¬¬ä¸‰ç§æ–¹å¼ï¼š
    å®ç°Callableæ¥å£
    è¿™ç§æ–¹å¼çš„ä¼˜ç‚¹ï¼šå¯ä»¥è·å–åˆ°çº¿ç¨‹çš„æ‰§è¡Œç»“æœã€‚
    è¿™ç§æ–¹å¼çš„ç¼ºç‚¹ï¼šæ•ˆç‡æ¯”è¾ƒä½ï¼Œåœ¨è·å–tçº¿ç¨‹æ‰§è¡Œç»“æœçš„æ—¶å€™ï¼Œå½“å‰çº¿ç¨‹å—é˜»å¡ï¼Œæ•ˆç‡è¾ƒä½ã€‚
 */
public class ThreadTest15 {
    public static void main(String[] args) throws Exception {

        // ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºä¸€ä¸ªâ€œæœªæ¥ä»»åŠ¡ç±»â€å¯¹è±¡ã€‚
        // å‚æ•°éå¸¸é‡è¦ï¼Œéœ€è¦ç»™ä¸€ä¸ªCallableæ¥å£å®ç°ç±»å¯¹è±¡ã€‚
        FutureTask task = new FutureTask(new Callable() {
            @Override
            public Object call() throws Exception { // call()æ–¹æ³•å°±ç›¸å½“äºrunæ–¹æ³•ã€‚åªä¸è¿‡è¿™ä¸ªæœ‰è¿”å›å€¼
                // çº¿ç¨‹æ‰§è¡Œä¸€ä¸ªä»»åŠ¡ï¼Œæ‰§è¡Œä¹‹åå¯èƒ½ä¼šæœ‰ä¸€ä¸ªæ‰§è¡Œç»“æœ
                // æ¨¡æ‹Ÿæ‰§è¡Œ
                System.out.println("call method begin");
                Thread.sleep(1000 * 10);
                System.out.println("call method end!");
                int a = 100;
                int b = 200;
                return a + b; //è‡ªåŠ¨è£…ç®±(300ç»“æœå˜æˆInteger)
            }
        });

        // åˆ›å»ºçº¿ç¨‹å¯¹è±¡
        Thread t = new Thread(task);

        // å¯åŠ¨çº¿ç¨‹
        t.start();

        // è¿™é‡Œæ˜¯mainæ–¹æ³•ï¼Œè¿™æ˜¯åœ¨ä¸»çº¿ç¨‹ä¸­ã€‚
        // åœ¨ä¸»çº¿ç¨‹ä¸­ï¼Œæ€ä¹ˆè·å–tçº¿ç¨‹çš„è¿”å›ç»“æœï¼Ÿ
        // get()æ–¹æ³•çš„æ‰§è¡Œä¼šå¯¼è‡´â€œå½“å‰çº¿ç¨‹é˜»å¡â€
        Object obj = task.get();
        System.out.println("çº¿ç¨‹æ‰§è¡Œç»“æœ:" + obj);

        // mainæ–¹æ³•è¿™é‡Œçš„ç¨‹åºè¦æƒ³æ‰§è¡Œå¿…é¡»ç­‰å¾…get()æ–¹æ³•çš„ç»“æŸ
        // è€Œget()æ–¹æ³•å¯èƒ½éœ€è¦å¾ˆä¹…ã€‚å› ä¸ºget()æ–¹æ³•æ˜¯ä¸ºäº†æ‹¿å¦ä¸€ä¸ªçº¿ç¨‹çš„æ‰§è¡Œç»“æœ
        // å¦ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œæ˜¯éœ€è¦æ—¶é—´çš„ã€‚
        System.out.println("hello world!");
    }
}
```





#### å››ã€ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…æ¨¡å¼

> ä½¿ç”¨`waitæ–¹æ³•`å’Œ`notifyæ–¹æ³•`å®ç°**â€œç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…æ¨¡å¼â€**

> æ³¨æ„ï¼š`waitå’Œnotifyæ–¹æ³•`**ä¸æ˜¯**çº¿ç¨‹å¯¹è±¡çš„æ–¹æ³•ï¼Œ**æ˜¯æ™®é€šJavaå¯¹è±¡ï¼ˆåœ¨Objectå°±æœ‰çš„ï¼‰éƒ½æœ‰çš„æ–¹æ³•**ã€‚
>
> waitæ–¹æ³•å’Œnotifyæ–¹æ³•å»ºç«‹åœ¨çº¿ç¨‹åŒæ­¥çš„åŸºç¡€ä¹‹ä¸Šã€‚å› ä¸ºå¤šçº¿ç¨‹è¦åŒæ—¶æ“ä½œä¸€ä¸ªä»“åº“ã€‚æœ‰çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚
>
> 1. `waitæ–¹æ³•`ä½œç”¨ï¼š`o.wait()`è®©æ­£åœ¨**oå¯¹è±¡**ä¸Šæ´»åŠ¨çš„**çº¿ç¨‹t**è¿›å…¥ç­‰å¾…çŠ¶æ€ï¼Œå¹¶ä¸”é‡Šæ”¾æ‰tçº¿ç¨‹ä¹‹å‰å æœ‰çš„oå¯¹è±¡çš„é”ã€‚
> 2. `notifyæ–¹æ³•`ä½œç”¨ï¼š`o.notify()`è®©æ­£åœ¨**oå¯¹è±¡**ä¸Šç­‰å¾…çš„çº¿ç¨‹å”¤é†’ï¼Œåªæ˜¯é€šçŸ¥ï¼Œ**ä¸ä¼šé‡Šæ”¾oå¯¹è±¡ä¸Šä¹‹å‰å æœ‰çš„é”**ã€‚



ä»£ç å®ç°ä¸€ç§éœ€æ±‚ï¼šä¸¤ä¸ªçº¿ç¨‹äº¤æ›¿è¿è¡Œï¼Œæ“ä½œåŒä¸€ä¸ªå¯¹è±¡ï¼Œå®ç°ä¸€ä¸ªçº¿ç¨‹è¾“å‡ºå¥‡æ•°ä¸€ä¸ªçº¿ç¨‹è¾“å‡ºå¶æ•°ä¸”æ•°å­—é€’å¢çš„æ•ˆæœã€‚



```java
/**
 * @author å°ç«å¨ƒ
 * @project_name: javase
 * @package_name: com.java.thread.producer
 */
public class ProducerAndCustomer {
    public static void main(String[] args) {
        // è®©numå¯¹è±¡çš„iä»0å¼€å§‹
        Num num = new Num(0);

        // åˆ›å»ºçº¿ç¨‹ï¼Œå…±äº«numå¯¹è±¡
        Thread t1 = new Thread(new Even(num));
        Thread t2 = new Thread(new Odd(num));

        // æ”¹å
        t1.setName("t1");
        t2.setName("t2");

        // å¼€å¯çº¿ç¨‹
        t1.start();
        t2.start();

    }
}

class Even implements Runnable {
    Num num;

    public Even(Num num) {
        this.num = num;
    }

    @Override
    public void run() {
        while (true) {
            // ç»™numå¯¹è±¡ä¸Šé”
            synchronized (num) {
                // å¦‚æœå½“å‰æ˜¯å¶æ•°çš„è¯ï¼Œæ”¾å¼ƒCPUæ‰§è¡Œæƒã€æ”¾å¼ƒnumå¯¹è±¡é”
                if (num.i % 2 != 0) {
                    try {
                        num.wait();
                    } catch (InterruptedException e) {
                        e.printStackTrace();
                    }
                }
                try {
                    Thread.sleep(1000);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
                // å¦‚æœæ˜¯å¥‡æ•°çš„è¯å°±è¾“å‡ºnumé‡Œçš„i
                System.out.println(Thread.currentThread().getName() + "-->" + num.i);
                // é€’å¢
                num.i++;
                // å”¤é†’å…¶ä»–ç­‰å¾…numå¯¹è±¡çš„çº¿ç¨‹
                num.notifyAll();
            }
        }
    }
}

class Odd implements Runnable {

    Num num;

    public Odd(Num num) {
        this.num = num;
    }

    @Override
    public void run() {
        while (true) {
            // è·å–numå¯¹è±¡é”
            synchronized (num) {
                // å¦‚æœæ˜¯å¶æ•°å°±æ”¾å¼ƒCPUæ‰§è¡Œæƒå’Œnumå¯¹è±¡é”
                if (num.i % 2 == 0) {
                    try {
                        num.wait();
                    } catch (InterruptedException e) {
                        e.printStackTrace();
                    }
                }
                try {
                    Thread.sleep(1000);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
                // å¦‚æœæ˜¯å¥‡æ•°å°±è¾“å‡ºå¯¹åº”å†…å®¹
                System.out.println(Thread.currentThread().getName() + "-->" + num.i);
                // é€’å¢
                num.i++;
                // å”¤é†’å…¶ä»–ç­‰å¾…numå¯¹è±¡çš„çº¿ç¨‹
                num.notifyAll();
            }
        }
    }
}

class Num {
    int i;

    public Num(int i) {
        this.i = i;
    }
}
```

å®ç°æ•ˆæœï¼š

![image-20220815141010671](https://s2.loli.net/2023/10/12/5jJYzbr2WlAvMH6.png)











# åå°„

## ä¸€ã€ä½œç”¨

1. é€šè¿‡javaè¯­è¨€ä¸­çš„åå°„æœºåˆ¶å¯ä»¥**æ“ä½œå­—èŠ‚ç æ–‡ä»¶**ï¼ˆå¯ä»¥è¯»å’Œä¿®æ”¹å­—èŠ‚ç æ–‡ä»¶ï¼‰ã€‚
2. é€šè¿‡åå°„æœºåˆ¶å¯ä»¥æ“ä½œä»£ç ç‰‡æ®µã€‚ï¼ˆclassæ–‡ä»¶ã€‚ï¼‰



## äºŒã€åå°„åœ¨`java.lang.reflect.*;`åŒ…ä¸‹



## ä¸‰ã€åå°„æœºåˆ¶ç›¸å…³çš„é‡è¦çš„ç±»

1. `java.lang.Class`ï¼šä»£è¡¨**æ•´ä¸ªå­—èŠ‚ç **ï¼Œä»£è¡¨ä¸€ä¸ªç±»å‹ï¼Œ**ä»£è¡¨æ•´ä¸ªç±»**ã€‚
2. `java.lang.reflect.Method`ï¼šä»£è¡¨å­—èŠ‚ç ä¸­çš„**æ–¹æ³•å­—èŠ‚ç **ã€‚ä»£è¡¨ç±»ä¸­çš„æ–¹æ³•ã€‚
3. `java.lang.reflect.Constructor`ï¼šä»£è¡¨å­—èŠ‚ç ä¸­çš„**æ„é€ æ–¹æ³•å­—èŠ‚ç **ã€‚ä»£è¡¨ç±»ä¸­çš„æ„é€ æ–¹æ³•
4. `java.lang.reflect.Field`ï¼šä»£è¡¨å­—èŠ‚ç ä¸­çš„**å±æ€§å­—èŠ‚ç **ã€‚ä»£è¡¨ç±»ä¸­çš„æˆå‘˜å˜é‡ï¼ˆé™æ€å˜é‡+å®ä¾‹å˜é‡ï¼‰ã€‚



## å››ã€è·å–`java.lang.Classå¯¹è±¡`çš„ä¸‰ç§æ–¹å¼

è¦æ“ä½œä¸€ä¸ªç±»çš„å­—èŠ‚ç ï¼Œéœ€è¦é¦–å…ˆè·å–åˆ°è¿™ä¸ªç±»çš„å­—èŠ‚ç å¯¹è±¡ï¼Œæ€ä¹ˆè·å–`java.lang.Class`å®ä¾‹ï¼Ÿ

1. ç¬¬ä¸€ç§ï¼š`Class c = Class.forName("å®Œæ•´ç±»åå¸¦åŒ…å");`

   - ä¸»è¦ç”¨é€”ï¼šå¤šç”¨äºé…ç½®æ–‡ä»¶ï¼Œè¯»å–ç±»å…¨è·¯å¾„ï¼ŒåŠ è½½ç±»ã€‚

   - `Class`çš„é™æ€æ–¹æ³•ã€æ–¹æ³•å‚æ•°æ˜¯ä¸ªå®Œæ•´ç±»åå¸¦åŒ…åçš„å­—ç¬¦ä¸²

   - ![image-20220815142538079](https://s2.loli.net/2023/10/12/e813ZzVRoUTmua2.png)

   - ```java
     c1 = Class.forName("java.lang.String"); // c1ä»£è¡¨String.classæ–‡ä»¶ï¼Œæˆ–è€…è¯´c1ä»£è¡¨Stringç±»å‹ã€‚
     c2 = Class.forName("java.util.Date"); // c2ä»£è¡¨Dateç±»å‹
     Class c3 = Class.forName("java.lang.Integer"); // c3ä»£è¡¨Integerç±»å‹
     Class c4 = Class.forName("java.lang.System"); // c4ä»£è¡¨Systemç±»å‹
     ```

2. ç¬¬äºŒç§ï¼š`Class c = å¯¹è±¡.getClass();`

3. ç¬¬ä¸‰ç§ï¼š`Class c = ä»»ä½•ç±»å‹.class;`

   - ä¸»è¦ç”¨é€”ï¼šå¤šç”¨äºå‚æ•°ä¼ é€’ï¼Œæ¯”å¦‚é€šè¿‡åå°„å¾—åˆ°å¯¹åº”æ„é€ å™¨å¯¹è±¡

   - ```java
     // ç¬¬ä¸‰ç§æ–¹å¼ï¼Œjavaè¯­è¨€ä¸­ä»»ä½•ä¸€ç§ç±»å‹ï¼ŒåŒ…æ‹¬åŸºæœ¬æ•°æ®ç±»å‹ï¼Œå®ƒéƒ½æœ‰.classå±æ€§ã€‚
     Class z = String.class; // zä»£è¡¨Stringç±»å‹
     Class k = Date.class; // kä»£è¡¨Dateç±»å‹
     Class f = int.class; // fä»£è¡¨intç±»å‹
     Class e = double.class; // eä»£è¡¨doubleç±»å‹
     ```

4. ç¬¬å››ç§ï¼šé€šè¿‡ç±»åŠ è½½å™¨

  - ~~~java
    ClassLoader cl = å¯¹è±¡.getClass().getClassLoader();
    Class clazz = cl.loadClass("ç±»çš„å…¨ç±»å");
    ~~~

  - 


**å¦‚æœæ˜¯åŒä¸€ä¸ªç±»ï¼Œé‚£ä¸‰ç§æ–¹æ³•è·å¾—çš„å¼•ç”¨éƒ½æŒ‡å‘æ–¹æ³•åŒºä¸­åŒä¸€ä¸ª`.class` æ–‡ä»¶ï¼Œä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ª`.class`**

**åœ¨ç±»åŠ è½½æ—¶é€šè¿‡ç±»åŠ è½½å™¨ClassLoaderçš„loadClass()æ–¹æ³•ï¼Œåˆ›å»ºå¯¹åº”çš„Classç±»å¯¹è±¡æ”¾åœ¨==å †å†…å­˜ä¸­==ï¼Œè¿™ä¸ªClasså¯¹è±¡==åªæœ‰ä¸€ä¸ª==ï¼›ä¸”ä¼šç”Ÿæˆ`.class`å­—èŠ‚ç äºŒè¿›åˆ¶æ•°æ® /  å…ƒæ•°æ®ï¼ˆå­˜åœ¨==æ–¹æ³•åŒº==å†…å­˜ä¸­ï¼‰**





æ‹“å±•ï¼š

1. åŸºæœ¬æ•°æ®ç±»å‹è·å–Classç±»å¯¹è±¡

   - ~~~
     Class cls = åŸºæœ¬æ•°æ®ç±»å‹.class
     ~~~

2. åŸºæœ¬æ•°æ®ç±»å‹çš„åŒ…è£…ç±»è·å–Classç±»å¯¹è±¡

   - ~~~
     Class cls  = åŒ…è£…ç±».TYPE
     ~~~

åº•å±‚ä¼šè¿›è¡Œè‡ªåŠ¨è£…ç®±æ‹†ç®±æ“ä½œï¼Œå®é™…ä¸ŠåŒä¸€ç§ç±»å‹çš„åŸºæœ¬æ•°æ®ç±»å‹å’ŒåŒ…è£…ç±»å‹æ‹¿åˆ°çš„Classå¯¹è±¡éƒ½æ˜¯åŒä¸€ä»½ï¼Œä¹Ÿåªæœ‰ä¸€ä»½















## äº”ã€ç”¨åå°„æœºåˆ¶ï¼ˆClassï¼‰å®ä¾‹åŒ–å¯¹è±¡çš„ä¼˜ç‚¹

==çµæ´»==

> 1. åœ¨é…ç½®æ–‡ä»¶ä¸­ç»™ä¸€ä¸ª`å®Œæ•´åŒ…å.ç±»å`
> 2. åœ¨Javaä»£ç ä¸­`Class.forName("åŒ…å.ç±»å").newInstance()`å³å¯åˆ›å»ºå‡ºå¯¹åº”çš„å¯¹è±¡ï¼Œæ¯”èµ·newæ¥å¾—çµæ´»
>    - æ³¨æ„ï¼š`newInstance()æ–¹æ³•`å†…éƒ¨å®é™…ä¸Š**è°ƒç”¨äº†æ— å‚æ•°æ„é€ æ–¹æ³•**ï¼Œå¿…é¡»ä¿è¯æ— å‚æ„é€ å­˜åœ¨æ‰å¯ä»¥ã€‚æ²¡æœ‰æ— å‚æ„é€ ä¼šæŠ¥é”™
>    - `newInstance()æ–¹æ³•`ä»JDK9å¼€å§‹å·²ç»è¿‡æ—¶äº†
> 3. ä¸ºä»€ä¹ˆè¯´çµæ´»å‘¢ï¼Ÿ
>    - å‡è®¾`"åŒ…å.ç±»å"`æ˜¯ä»é…ç½®æ–‡ä»¶è¯»å‡ºæ¥çš„ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä»…ä¿®æ”¹é…ç½®æ–‡ä»¶è€Œä¸éœ€è¦åŠ¨Javaä»£ç å°±å¯ä»¥å®ä¾‹åŒ–ä¸åŒçš„å¯¹è±¡äº†ï¼è¿™æ ·å†™æ›´ç¬¦åˆ**OCPå¼€é—­åŸåˆ™**

```java
public static void main(String[] args) {

    // è¿™æ˜¯ä¸ä½¿ç”¨åå°„æœºåˆ¶ï¼Œåˆ›å»ºå¯¹è±¡
    User user = new User();
    System.out.println(user);

    // ä¸‹é¢è¿™æ®µä»£ç æ˜¯ä»¥åå°„æœºåˆ¶çš„æ–¹å¼åˆ›å»ºå¯¹è±¡ã€‚
    try {
        // é€šè¿‡åå°„æœºåˆ¶ï¼Œè·å–Classï¼Œé€šè¿‡Classæ¥å®ä¾‹åŒ–å¯¹è±¡
        Class c = Class.forName("com.java.bean.User"); // cä»£è¡¨Userç±»å‹ã€‚

        // newInstance() è¿™ä¸ªæ–¹æ³•ä¼šè°ƒç”¨Userè¿™ä¸ªç±»çš„æ— å‚æ•°æ„é€ æ–¹æ³•ï¼Œå®Œæˆå¯¹è±¡çš„åˆ›å»ºã€‚
        // é‡ç‚¹æ˜¯ï¼šnewInstance()è°ƒç”¨çš„æ˜¯æ— å‚æ„é€ ï¼Œå¿…é¡»ä¿è¯æ— å‚æ„é€ æ˜¯å­˜åœ¨çš„ï¼
        Object obj = c.newInstance();

        System.out.println(obj); // com.bjpowernode.java.bean.User@10f87f48
    } catch (ClassNotFoundException e) {
        e.printStackTrace();
    } catch (IllegalAccessException e) {
        e.printStackTrace();
    } catch (InstantiationException e) {
        e.printStackTrace();
    }
}
```

## å…­ã€Class.forName()

==Class.forName("å®Œæ•´ç±»åå¸¦åŒ…å");==

- è¿™ä¸ªæ–¹æ³•çš„æ‰§è¡Œä¼šå¯¼è‡´**ç±»åŠ è½½**ï¼Œç±»åŠ è½½æ—¶ï¼Œ**é™æ€ä»£ç å—æ‰§è¡Œ**ã€‚

- å¦‚æœä¸æƒ³è®©ç±»çš„å…¶ä»–ä»£ç æ‰§è¡Œï¼Œå¯ä»¥åªç”¨`Class.forName("å®Œæ•´ç±»åå¸¦åŒ…å");`æ¥è£…è½½ç±»





## ä¸ƒã€:star::star:è·å–Fieldï¼ˆå±æ€§ï¼‰

1. `classå¯¹è±¡.getFields()`å¯ä»¥è·å–**publicä¿®é¥°çš„Field**ç»„æˆçš„æ•°ç»„
2. `classå¯¹è±¡.getDeclaredFields();`å¯ä»¥è·å–**æ‰€æœ‰Field**ç»„æˆçš„æ•°ç»„
3. `fieldå¯¹è±¡.getName()`å¯ä»¥è·å–**å±æ€§å**
4. `fieldå¯¹è±¡.getModifiers();`å¯ä»¥è·å–å±æ€§çš„**ä¿®é¥°ç¬¦åˆ—è¡¨**ï¼Œä½†æ˜¯è¿”å›çš„æ˜¯intç±»å‹çš„**ä»£å·**
   - ç”¨`Modifier.toString(ä»£å·);`å¯ä»¥æŠŠä»£å·è½¬æˆå­—ç¬¦ä¸²
5. `fieldå¯¹è±¡.getType()`å¯ä»¥è·å–**æ•°æ®ç±»å‹**
   - æ•°æ®ç±»å‹è¿˜å¯ä»¥`.getSimpleName();`è·å¾—ç®€å†™çš„



```java
import java.lang.reflect.Field;
import java.lang.reflect.Modifier;

/*
	åå°„Studentç±»å½“ä¸­æ‰€æœ‰çš„Fieldï¼ˆäº†è§£ä¸€ä¸‹ï¼‰
 */
public class ReflectTest {
    public static void main(String[] args) throws Exception{

        // è·å–æ•´ä¸ªç±»
        Class studentClass = Class.forName("com.java.bean.Student");
        
        String className = studentClass.getName();
        System.out.println("å®Œæ•´ç±»åï¼š" + className); //com.java.bean.Student

        String simpleName = studentClass.getSimpleName();
        System.out.println("ç®€ç±»åï¼š" + simpleName); //Student

        // è·å–ç±»ä¸­æ‰€æœ‰çš„publicä¿®é¥°çš„Field
        Field[] fields = studentClass.getFields();
        System.out.println(fields.length); // æµ‹è¯•æ•°ç»„ä¸­åªæœ‰1ä¸ªå…ƒç´ 
        // å–å‡ºè¿™ä¸ªField
        Field f = fields[0];
        // å–å‡ºè¿™ä¸ªFieldå®ƒçš„åå­—
        String fieldName = f.getName();
        System.out.println(fieldName);

        // è·å–æ‰€æœ‰çš„Field
        Field[] fs = studentClass.getDeclaredFields();
        System.out.println(fs.length); // 4

        System.out.println("==================================");
        // éå†
        for(Field field : fs){
            // è·å–å±æ€§çš„ä¿®é¥°ç¬¦åˆ—è¡¨
            int i = field.getModifiers(); // è¿”å›çš„ä¿®é¥°ç¬¦æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œæ¯ä¸ªæ•°å­—æ˜¯ä¿®é¥°ç¬¦çš„ä»£å·ï¼ï¼ï¼
            System.out.println(i);
            // å¯ä»¥å°†è¿™ä¸ªâ€œä»£å·â€æ•°å­—è½¬æ¢æˆâ€œå­—ç¬¦ä¸²â€å—ï¼Ÿ
            String modifierString = Modifier.toString(i);
            System.out.println(modifierString);
            // è·å–å±æ€§çš„ç±»å‹
            Class fieldType = field.getType();
            //String fName = fieldType.getName();
            String fName = fieldType.getSimpleName();
            System.out.println(fName);
            // è·å–å±æ€§çš„åå­—
            System.out.println(field.getName());
        }
    }
}
```



### é€šè¿‡è·å–fieldæ¥æ‹¼æ¥å‡ºç±»ä¸­çš„å±æ€§

ä»¥åä¸ä¼šç”¨åˆ°çš„ï¼Œ

```java
import java.lang.reflect.Field;
import java.lang.reflect.Modifier;

/**
 * @author å°ç«å¨ƒ
 * @project_name: javase
 * @package_name: com.java.reflect
 */
public class MyReTest {
    public static void main(String[] args) throws ClassNotFoundException {
        Class<?> studentClass = Class.forName("java.lang.Thread");

        StringBuffer buffer = new StringBuffer();

        buffer.append(Modifier.toString(studentClass.getModifiers())+ " class " + studentClass.getSimpleName() + " {\n");

        for (Field field : studentClass.getDeclaredFields()) {
            buffer.append("\t");
            // è·å–ä¿®é¥°ç¬¦
            buffer.append(Modifier.toString(field.getModifiers()));
            buffer.append(" ");
            // è·å–ç±»å‹
            buffer.append(field.getType().getSimpleName());
            buffer.append(" ");
            // è·å–åå­—
            buffer.append(field.getName());
            buffer.append(";\n");
        }

        buffer.append("}");
        System.out.println(buffer);
    }
}
```



![image-20220815212007446](https://s2.loli.net/2023/10/12/8PLUVk16x4r2Dya.png)





### :star::star:åˆ©ç”¨åå°„è·å–å’Œè®¾ç½®å±æ€§å€¼

ç”¨æ³•ï¼š

1. é€šè¿‡`Classå¯¹è±¡.newInstance();`è·å¾—ä¸€ä¸ªç±»çš„`å®ä¾‹`
2. é€šè¿‡`Classå¯¹è±¡.getDeclaredField(å±æ€§å);`è·å¾—å¯¹åº”å±æ€§ï¼ˆFieldï¼‰
   - å¦‚æœæ˜¯ç§æœ‰çš„ä»…ç”¨è¿™ä¸ªæ–¹å¼æ˜¯ä¸èƒ½è®¿é—®çš„
   - éœ€è¦`Fieldå¯¹è±¡.setAccessible(true);`æ¥è®©ç§æœ‰å±æ€§å¯ä»¥è®¿é—®
   - è¿™ä¹Ÿæ˜¯**åå°„çš„ç¼ºç‚¹**ï¼šä¼šç ´åå°è£…ï¼Œå¯èƒ½é€ æˆå±é™©
3. `Fieldå¯¹è±¡.set(å®ä¾‹, å€¼);`ç»™å®ä¾‹çš„fieldä¸Šèµ‹å€¼
4. `Fieldå¯¹è±¡.get(å®ä¾‹);`è·å–å®ä¾‹çš„fieldçš„å€¼

```java
import com.java.bean.Student;

import java.lang.reflect.Field;

/*
å¿…é¡»æŒæ¡ï¼š
    æ€ä¹ˆé€šè¿‡åå°„æœºåˆ¶è®¿é—®ä¸€ä¸ªjavaå¯¹è±¡çš„å±æ€§ï¼Ÿ
        ç»™å±æ€§èµ‹å€¼set
        è·å–å±æ€§çš„å€¼get
 */
public class ReflectTest {
    public static void main(String[] args) throws Exception{

        // æˆ‘ä»¬ä¸ä½¿ç”¨åå°„æœºåˆ¶ï¼Œæ€ä¹ˆå»è®¿é—®ä¸€ä¸ªå¯¹è±¡çš„å±æ€§å‘¢ï¼Ÿ
        Student s = new Student();

        // ç»™å±æ€§èµ‹å€¼
        s.no = 1111; //ä¸‰è¦ç´ ï¼šç»™så¯¹è±¡çš„noå±æ€§èµ‹å€¼1111
                    //è¦ç´ 1ï¼šå¯¹è±¡s
                    //è¦ç´ 2ï¼šnoå±æ€§
                    //è¦ç´ 3ï¼š1111

        // è¯»å±æ€§å€¼
        // ä¸¤ä¸ªè¦ç´ ï¼šè·å–så¯¹è±¡çš„noå±æ€§çš„å€¼ã€‚
        System.out.println(s.no);

        // ä½¿ç”¨åå°„æœºåˆ¶ï¼Œæ€ä¹ˆå»è®¿é—®ä¸€ä¸ªå¯¹è±¡çš„å±æ€§ã€‚ï¼ˆset getï¼‰
        Class studentClass = Class.forName("com.java.bean.Student");
        Object obj = studentClass.newInstance(); // objå°±æ˜¯Studentå¯¹è±¡ã€‚ï¼ˆåº•å±‚è°ƒç”¨æ— å‚æ•°æ„é€ æ–¹æ³•ï¼‰

        // è·å–noå±æ€§ï¼ˆæ ¹æ®å±æ€§çš„åç§°æ¥è·å–Fieldï¼‰
        Field noFiled = studentClass.getDeclaredField("no");

        // ç»™objå¯¹è±¡(Studentå¯¹è±¡)çš„noå±æ€§èµ‹å€¼
        /*
        è™½ç„¶ä½¿ç”¨äº†åå°„æœºåˆ¶ï¼Œä½†æ˜¯ä¸‰è¦ç´ è¿˜æ˜¯ç¼ºä¸€ä¸å¯ï¼š
            è¦ç´ 1ï¼šobjå¯¹è±¡
            è¦ç´ 2ï¼šnoå±æ€§
            è¦ç´ 3ï¼š2222å€¼
        æ³¨æ„ï¼šåå°„æœºåˆ¶è®©ä»£ç å¤æ‚äº†ï¼Œä½†æ˜¯ä¸ºäº†ä¸€ä¸ªâ€œçµæ´»â€ï¼Œè¿™ä¹Ÿæ˜¯å€¼å¾—çš„ã€‚
         */
        noFiled.set(obj, 22222); // ç»™objå¯¹è±¡çš„noå±æ€§èµ‹å€¼2222

        // è¯»å–å±æ€§çš„å€¼
        // ä¸¤ä¸ªè¦ç´ ï¼šè·å–objå¯¹è±¡çš„noå±æ€§çš„å€¼ã€‚
        System.out.println(noFiled.get(obj));

        // å¯ä»¥è®¿é—®ç§æœ‰çš„å±æ€§å—ï¼Ÿ
        Field nameField = studentClass.getDeclaredField("name");

        // æ‰“ç ´å°è£…ï¼ˆåå°„æœºåˆ¶çš„ç¼ºç‚¹ï¼šæ‰“ç ´å°è£…ï¼Œå¯èƒ½ä¼šç»™ä¸æ³•åˆ†å­ç•™ä¸‹æœºä¼šï¼ï¼ï¼ï¼‰
        // è¿™æ ·è®¾ç½®å®Œä¹‹åï¼Œåœ¨å¤–éƒ¨ä¹Ÿæ˜¯å¯ä»¥è®¿é—®privateçš„ã€‚
        nameField.setAccessible(true);

        // ç»™nameå±æ€§èµ‹å€¼
        nameField.set(obj, "jackson");
        // è·å–nameå±æ€§çš„å€¼
        System.out.println(nameField.get(obj));
    }
}
```





## å…«ã€:star::star::star:è·å–Method

### åˆ©ç”¨åå°„è·å–æ–¹æ³•ç­¾åå†…å®¹

1. é€šè¿‡`Classå¯¹è±¡.getDeclaredMethods();`è·å–æ‰€æœ‰`Methodæ•°ç»„`
2. éå†`Methodæ•°ç»„`æ‹¿åˆ°æ¯ä¸ª`method`
3. ç”¨`Modifier.toString(method.getModifiers())`**è·å–ä¿®é¥°ç¬¦åˆ—è¡¨**
4. ç”¨`method.getReturnType().getSimpleName()`**è·å–è¿”å›å€¼ç±»å‹**
5. ç”¨`method.getName()`**è·å–æ–¹æ³•å**
6. ç”¨`method.getParameterTypes();`è·å–`Classæ•°ç»„`çš„**å‚æ•°ä¿®é¥°ç¬¦åˆ—è¡¨**
7. éå†è¿™ä¸ªä¿®é¥°ç¬¦åˆ—è¡¨ï¼Œç”¨æ¯ä¸ª`Classå¯¹è±¡.getSimpleName()`å³å¯è·å–**å‚æ•°ç±»å‹**

```java
import java.lang.reflect.Method;
import java.lang.reflect.Modifier;

public class ReflectTest {
    public static void main(String[] args) throws Exception{

        // è·å–ç±»äº†
        Class userServiceClass = Class.forName("com.java.service.UserService");

        // è·å–æ‰€æœ‰çš„Methodï¼ˆåŒ…æ‹¬ç§æœ‰çš„ï¼ï¼‰
        Method[] methods = userServiceClass.getDeclaredMethods();
        //System.out.println(methods.length); // 2

        // éå†Method
        for(Method method : methods){
            // è·å–ä¿®é¥°ç¬¦åˆ—è¡¨
            System.out.println(Modifier.toString(method.getModifiers()));
            // è·å–æ–¹æ³•çš„è¿”å›å€¼ç±»å‹
            System.out.println(method.getReturnType().getSimpleName());
            // è·å–æ–¹æ³•å
            System.out.println(method.getName());
            // æ–¹æ³•çš„å‚æ•°ä¿®é¥°ç¬¦åˆ—è¡¨ï¼ˆä¸€ä¸ªæ–¹æ³•çš„å‚æ•°å¯èƒ½ä¼šæœ‰å¤šä¸ªã€‚ï¼‰
            Class[] parameterTypes = method.getParameterTypes();
            for(Class parameterType : parameterTypes){
                System.out.println(parameterType.getSimpleName());
            }
        }
    }
}
```



### åç¼–è¯‘Method

```java
import java.lang.reflect.Method;
import java.lang.reflect.Modifier;

/**
 * @author å°ç«å¨ƒ
 * @project_name: javase
 * @package_name: com.java.reflect
 */
public class ReMethod{
    public static void main(String[] args) throws Exception{
        Class<?> userServiceClass = Class.forName("com.java.service.UserService");

        StringBuffer buffer = new StringBuffer();

        // æ‹¼ä¸Šç±»å
        buffer.append(Modifier.toString(userServiceClass.getModifiers())  + " class " + userServiceClass.getSimpleName() + " {\n");

        // è·å–æ‰€æœ‰æ–¹æ³•
        for (Method declaredMethod : userServiceClass.getDeclaredMethods()) {
            buffer.append("\t");
            buffer.append(Modifier.toString(declaredMethod.getModifiers()));  // è·å–æ–¹æ³•çš„ä¿®é¥°ç¬¦
            buffer.append(" ");
            buffer.append(declaredMethod.getReturnType().getSimpleName());  // è·å–æ–¹æ³•çš„è¿”å›å€¼ç±»å‹
            buffer.append(" ");
            buffer.append(declaredMethod.getName());  // è·å–æ–¹æ³•åå­—
            buffer.append("(");  // æ‹¼ä¸Šå‚æ•°çš„å·¦æ‹¬å·
            Class<?>[] parameterTypes = declaredMethod.getParameterTypes();  // è·å–å‚æ•°æ•°ç»„
            for (Class<?> parameterType : parameterTypes) {
                buffer.append(parameterType.getSimpleName());  // è·å–å‚æ•°ç±»å‹
                buffer.append(",");
            }
            // å¦‚æœæ˜¯æ— å‚çš„è¯ï¼Œâ€œ,â€çš„ä½ç½®å°±ä¸ä¼šåœ¨å‚æ•°åˆ—è¡¨é‡Œï¼Œå°±ä¸ä¼šå¤šåˆ å·¦æ‹¬å·
            // å¦‚æœæ˜¯æœ‰å‚çš„è¯ï¼Œâ€œ,â€ä¼šåœ¨æœ€åå¤šä¸€ä¸ªï¼Œåªè¦ç”¨length-1å°±å°±èƒ½åˆ¤æ–­å¹¶åˆ æ‰äº†
            if (buffer.lastIndexOf(",") == buffer.length() - 1){
                buffer.deleteCharAt(buffer.length() - 1);
            }
            buffer.append(") {}\n");  // æ–¹æ³•ç»“å°¾
        }
        buffer.append("}");  // ç±»ç»“å°¾

        System.out.println(buffer);
    }

}
```



### :star::star::star:é€šè¿‡åå°„æœºåˆ¶è°ƒç”¨æ–¹æ³•

é€šè¿‡`Methodå¯¹è±¡.invoke`æ¥:staé€šè¿‡åå°„æœºåˆ¶è°ƒç”¨æ–¹æ³•

![image-20220816230559615](https://s2.loli.net/2023/10/12/cdxG6emiL1UI85V.png)

> åœ¨Javaä¸­ï¼Œæ–¹æ³•çš„è°ƒç”¨éœ€è¦ä»¥ä¸‹å››è¦ç´ ï¼š
>
> 1. å¯¹è±¡ï¼ˆé™æ€æ–¹æ³•å°±ç±»ï¼‰
> 2. æ–¹æ³•å
> 3. å½¢å‚
> 4. è¿”å›å€¼
>
> ç¡®å®šä¸€ä¸ªæ–¹æ³•çš„æ–¹å¼ä¸»è¦é åœ¨ä¸€ä¸ªç±»é‡Œçš„ **æ–¹æ³•å + å½¢å‚ç±»å‹æ•°é‡**ï¼ˆå¦‚æœå‡ºç°é‡è½½çš„è¯ï¼Œä¸¤ä¸ªæ–¹æ³•æœ‰ç›¸åŒæ•°é‡çš„å½¢å‚ï¼Œé‚£è¿™äº›å½¢å‚å°±ä¸ä¼šæœ‰ç›¸åŒçš„ç±»å‹ï¼‰æ¥ç¡®å®š

> é€šè¿‡åå°„æœºåˆ¶è°ƒç”¨æ–¹æ³•ï¼š
>
> 1. è·å–`ç±»çš„Classå¯¹è±¡`
> 2. è·å–`Classå¯¹è±¡çš„å®ä¾‹`
> 3. é€šè¿‡`Classå¯¹è±¡.getDeclaredMethod("æŒ‡å®šæ–¹æ³•å"[, String.class, String.class]);`æ¥**è·å–å¯¹åº”çš„æ–¹æ³•**
>    - ![image-20220816225912780](https://s2.loli.net/2023/10/12/YuT4KmQo6FN3GHP.png)
>    - `getDeclaredMethod`ä¼ å…¥**ä¸€ä¸ªæ–¹æ³•å**åŠ ä¸Š**å½¢å‚çš„ç±»çš„å­—èŠ‚ç **
> 4. é€šè¿‡`æ–¹æ³•å.invoke(Classå¯¹è±¡çš„å®ä¾‹, "Stringå½¢å‚", "Stringå½¢å‚");`æ¥è·å–**è¿”å›å€¼**

![image-20220816230435709](https://s2.loli.net/2023/10/12/TuV5oxwhbfZF1L4.png)

```java
import java.lang.reflect.Method;

/**
 * @author å°ç«å¨ƒ
 * @project_name: javase
 * @package_name: com.java.reflect
 */
public class MyUserMethod {
    public static void main(String[] args) throws Exception {
        // è·å–Classå¯¹è±¡
        Class<?> userServiceClass = Class.forName("com.java.service.UserService");

        // å®ä¾‹åŒ–
        Object userService = userServiceClass.newInstance();

        // Classå¯¹è±¡è·å–æŒ‡å®šåå­—çš„æ–¹æ³•ï¼Œç»™å®šå½¢å‚çš„ç±»çš„å­—èŠ‚ç 
        Method login = userServiceClass.getDeclaredMethod("login", String.class, String.class);

        /*
            æ–¹æ³•è°ƒç”¨çš„å››è¦ç´ ï¼š
            å«loginçš„æ–¹æ³•
            å«userServiceçš„å¯¹è±¡
            "root","pwd" å®å‚
            returnValue è¿”å›å€¼
         */
        Object returnValue = login.invoke(userService, "root", "pwd");

        System.out.println(returnValue);  // true

    }
}
```



## ä¹ã€:star:è·å–æ„é€ æ–¹æ³•Constructor

### è·å–æ„é€ æ–¹æ³•

```java
import java.lang.reflect.Constructor;
import java.lang.reflect.Modifier;

/**
 * @author å°ç«å¨ƒ
 * @project_name: javase
 * @package_name: com.java.reflect
 */
public class MyReCon {
    public static void main(String[] args) throws Exception {
        // è·å–Classå¯¹è±¡
        Class<?> vipClass = Class.forName("com.java.bean.Vip");

        StringBuffer buffer = new StringBuffer();

        buffer.append(Modifier.toString(vipClass.getModifiers()) + " class " + vipClass.getSimpleName() + " {\n");

        // è·å–æ‰€æœ‰æ„é€ æ–¹æ³•
        Constructor<?>[] constructors = vipClass.getDeclaredConstructors();
        for (Constructor<?> constructor : constructors) {
            buffer.append("\t");
            // ä¿®é¥°ç¬¦
            buffer.append(Modifier.toString(constructor.getModifiers()));
            buffer.append(" ");
            // æ„é€ æ–¹æ³•ç›´æ¥ç”¨ç±»å
            buffer.append(vipClass.getSimpleName());
            buffer.append("(");
            // æ‹¼æ¥å‚æ•°
            Class<?>[] parameterTypes = constructor.getParameterTypes();
            for (Class<?> parameterType : parameterTypes) {
                buffer.append(parameterType.getSimpleName());
                buffer.append(",");
            }
            // åˆ é™¤æœ‰å‚æ„é€ çš„æœ€åä¸€ä¸ªå¤šä½™çš„é€—å·
            if (parameterTypes.length != 0) {
                buffer.deleteCharAt(buffer.length() - 1);
            }
            buffer.append(") {}\n");
        }

        buffer.append("}");
        System.out.println(buffer);
    }
}
```



### :star:é€šè¿‡åå°„æœºåˆ¶åˆ›å»ºå¯¹è±¡

> åœ¨ä¸€ä¸ªç±»ä¸­ï¼ŒåŒºåˆ†æ„é€ æ–¹æ³•åªèƒ½é€šè¿‡å®ƒä»¬å‚æ•°çš„ä¸åŒï¼ˆå› ä¸ºåå­—éƒ½æ˜¯ç±»åï¼‰
>
> 1. æ— å‚æ„é€ å¯ä»¥é€šè¿‡`Classå¯¹è±¡.newInstance();`ï¼ˆJDK9ä¹‹åå°±è¿‡æ—¶çš„ï¼‰æ¥è°ƒç”¨
>    - æ— å‚æ„é€ ä¹Ÿå¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹æ³•æ¥è°ƒç”¨
> 2. æœ‰å‚å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹æ³•æ¥è°ƒç”¨

1. é€šè¿‡`Classå¯¹è±¡.getDeclaredConstructor(ç±»<?>... parameterTypes)` æ¥è·å–ä¸€ä¸ªæ„é€ æ–¹æ³•
   - ![image-20220817120542742](https://s2.loli.net/2023/10/12/pmHMXa7dhbEvgG8.png)
2. ç”¨`æ„é€ æ–¹æ³•å¯¹è±¡.newInstance(å‚æ•°...)`å¯ä»¥è°ƒç”¨æœ‰å‚æ„é€ 
   - å…·ä½“è¦ä¼ å…¥å‡ ä¸ªå‚æ•°æ ¹æ®è·å–æ„é€ æ–¹æ³•çš„æ—¶å€™ç»™çš„å‚æ•°æ¥å®š



```java
import java.lang.reflect.Constructor;

/**
 * @author å°ç«å¨ƒ
 * @project_name: javase
 * @package_name: com.java.reflect
 */
public class MyReConNew {
    public static void main(String[] args) throws Exception {
        Class<?> aClass = Class.forName("com.java.bean.Vip");

        // è·å–æ— å‚æ„é€ ï¼Œæ–¹æ³•ä¸€
        Object obj1 = aClass.newInstance();
        System.out.println(obj1);

        // è·å–æ— å‚æ„é€ ï¼Œæ–¹æ³•äºŒ
        Constructor<?> constructor = aClass.getDeclaredConstructor();
        Object obj2 = constructor.newInstance();  // è°ƒæ— å‚å°±ç›´æ¥newInstance();å°±è¡Œ
        System.out.println(obj2);

        // è·å–æœ‰å‚æ„é€ 
        Constructor<?> constructor1 = aClass.getDeclaredConstructor(int.class, String.class, String.class);  // å‚æ•°æ ¹æ®æ„é€ æ–¹æ³•çš„æ¥
        Object obj3 = constructor1.newInstance(666, "haha", "gg");
        System.out.println(obj3);

    }
}
```







## åã€:star::star:è·å–å®ç°çš„æ¥å£å’Œçˆ¶ç±»

- `Classå¯¹è±¡.getSuperclass()`**è·å–çˆ¶ç±»**
- `Classå¯¹è±¡.getInterfaces()`**è·å–æ¥å£**ï¼ˆå› ä¸ºå¯ä»¥å®ç°å¤šä¸ªæ¥å£ï¼Œæ‰€ä»¥**è¿”å›çš„æ˜¯Classæ•°ç»„**ï¼‰

```java
public class ReflectTest {
    public static void main(String[] args) throws Exception{

        // Stringä¸¾ä¾‹
        Class stringClass = Class.forName("java.lang.String");

        // è·å–Stringçš„çˆ¶ç±»
        Class superClass = stringClass.getSuperclass();
        System.out.println(superClass.getName());

        // è·å–Stringç±»å®ç°çš„æ‰€æœ‰æ¥å£ï¼ˆä¸€ä¸ªç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£ã€‚ï¼‰
        Class[] interfaces = stringClass.getInterfaces();
        for(Class in : interfaces){
            System.out.println(in.getName());
        }
    }
}
```





## åä¸€ã€åå°„ä¼˜åŒ–

> é€šè¿‡å…³é—­è®¿é—®æ£€æŸ¥æ¥æé«˜æ•ˆç‡
>
> åœ¨`Method`ï¼Œ`Field`ï¼Œ`Constructor`ä¸­éƒ½æœ‰`setAccessible()æ–¹æ³•`
>
> å°†å…¶è®¾ç½®ä¸º**true**æ—¶ï¼Œä»£è¡¨åå°„å¯¹è±¡åœ¨ä½¿ç”¨æ—¶å–æ¶ˆè®¿é—®æ£€æŸ¥ï¼Œä¼šæé«˜ä¸€ç‚¹åå°„çš„æ•ˆç‡ã€‚
>
> å°†å…¶è®¾ç½®ä¸º**false**æ—¶ï¼Œä»£è¡¨æ‰§è¡Œè®¿é—®æ£€æŸ¥



~~~
ç»“æœï¼š
method1 è€—æ—¶ï¼š11
method2 è€—æ—¶ï¼š3520
method3 è€—æ—¶ï¼š146

Process finished with exit code 0
~~~

```java
package com.xiaohuowa.reflect;

import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;

/**
 * @author å°ç«å¨ƒ
 * @project_name: my_projects
 * @package_name: com.xiaohuowa.reflect
 */
public class YouHuaReflect {
    public static void main(String[] args) throws ClassNotFoundException, InvocationTargetException, InstantiationException, IllegalAccessException, NoSuchMethodException {
        method1();
        method2();
        method3();
    }

    static void method1() {
        // è®¡ç®—å¼€å§‹æ—¶é—´
        long start = System.currentTimeMillis();
        A a = new A();
        // é‡å¤è°ƒç”¨æ–¹æ³•ï¼Œä¸ºäº†è®©ç»“æœæ›´åŠ æ˜æ˜¾ä¸€ç‚¹
        for (int i = 0; i < 9999999; i++) {
            a.m1();
        }
        // è®°å½•ç»“æŸæ—¶é—´
        long end = System.currentTimeMillis();
        // è¾“å‡ºç»“æœ
        System.out.println("method1 è€—æ—¶ï¼š" + (end - start));
    }

    static void method2() throws ClassNotFoundException, InstantiationException, IllegalAccessException, NoSuchMethodException, InvocationTargetException {
        long start = System.currentTimeMillis();
        Class<?> aClass = Class.forName("com.xiaohuowa.reflect.A");
        Object o = aClass.newInstance();
        Method m1 = aClass.getMethod("m1");
        for (int i = 0; i < 9999999; i++) {
            m1.invoke(o);
        }
        long end = System.currentTimeMillis();
        System.out.println("method2 è€—æ—¶ï¼š" + (end - start));
    }

    static void method3() throws ClassNotFoundException, InstantiationException, IllegalAccessException, NoSuchMethodException, InvocationTargetException {
        long start = System.currentTimeMillis();
        Class<?> aClass = Class.forName("com.xiaohuowa.reflect.A");
        Object o = aClass.newInstance();
        Method m1 = aClass.getMethod("m1");
        m1.setAccessible(true);  // å–æ¶ˆè®¿é—®æ£€æŸ¥ï¼Œä¼šåŠ å¿«ä¸€ç‚¹ç‚¹é€Ÿåº¦
        for (int i = 0; i < 9999999; i++) {
            m1.invoke(o);
        }
        long end = System.currentTimeMillis();
        System.out.println("method3 è€—æ—¶ï¼š" + (end - start));
    }


}

class A{
    public void m1(){}
}
```













# æ³¨è§£

## æ¦‚è¿°

æ³¨è§£ï¼Œæˆ–è€…å«åšæ³¨é‡Šç±»å‹ï¼Œè‹±æ–‡å•è¯æ˜¯ï¼šAnnotationï¼Œæ˜¯ä¸€ç§å¼•ç”¨æ•°æ®ç±»å‹ã€‚ç¼–è¯‘ä¹‹åä¹Ÿæ˜¯ç”Ÿæˆxxx.classæ–‡ä»¶ã€‚

### å®šä¹‰æ³¨è§£ï¼š

```java
 [ä¿®é¥°ç¬¦åˆ—è¡¨] @interface æ³¨è§£ç±»å‹å{

 }
```



### ä½¿ç”¨æ³¨è§£ï¼š

æ³¨è§£ä½¿ç”¨æ—¶çš„è¯­æ³•æ ¼å¼æ˜¯ï¼š@æ³¨è§£ç±»å‹å

æ³¨è§£å¯ä»¥å‡ºç°åœ¨ç±»ä¸Šã€å±æ€§ä¸Šã€æ–¹æ³•ä¸Šã€å˜é‡ä¸Šã€æ³¨è§£è¿˜å¯ä»¥å‡ºç°åœ¨æ³¨è§£ç±»å‹ä¸Šç­‰....



### å…ƒæ³¨è§£æ¦‚å¿µ

ç”¨æ¥æ ‡æ³¨â€œæ³¨è§£ç±»å‹â€çš„â€œæ³¨è§£â€ï¼Œç§°ä¸ºå…ƒæ³¨è§£ã€‚



## JDKè‡ªå¸¦æ³¨è§£

### java.langåŒ…ä¸‹çš„æ³¨é‡Šç±»å‹

	æŒæ¡ï¼š
	Deprecated ç”¨ @Deprecated æ³¨é‡Šçš„ç¨‹åºå…ƒç´ ï¼Œä¸é¼“åŠ±ç¨‹åºå‘˜ä½¿ç”¨è¿™æ ·çš„å…ƒç´ ï¼Œé€šå¸¸æ˜¯å› ä¸ºå®ƒå¾ˆå±é™©æˆ–å­˜åœ¨æ›´å¥½çš„é€‰æ‹©ã€‚ 
	
	æŒæ¡ï¼š
	Override è¡¨ç¤ºä¸€ä¸ªæ–¹æ³•å£°æ˜æ‰“ç®—é‡å†™è¶…ç±»ä¸­çš„å¦ä¸€ä¸ªæ–¹æ³•å£°æ˜ã€‚ ä¸»è¦æ˜¯ç”¨æ¥ç»™ç¼–è¯‘å™¨çœ‹çš„ï¼Œè·Ÿè¿è¡Œé˜¶æ®µæ— å…³ï¼Œè®©å®ƒçŸ¥é“è¢«æ³¨è§£çš„è¿™ä¸ªæ–¹æ³•æ˜¯ä¸ªé‡å†™çˆ¶ç±»çš„æ–¹æ³•ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨è¿›è¡Œæ£€æŸ¥ã€‚
	
	ä¸ç”¨æŒæ¡ï¼š
	SuppressWarnings æŒ‡ç¤ºåº”è¯¥åœ¨æ³¨é‡Šå…ƒç´ ï¼ˆä»¥åŠåŒ…å«åœ¨è¯¥æ³¨é‡Šå…ƒç´ ä¸­çš„æ‰€æœ‰ç¨‹åºå…ƒç´ ï¼‰ä¸­å–æ¶ˆæ˜¾ç¤ºæŒ‡å®šçš„ç¼–è¯‘å™¨è­¦å‘Šã€‚ 



### å…³äºTargetæ³¨è§£

		è¿™æ˜¯ä¸€ä¸ªå…ƒæ³¨è§£ï¼Œç”¨æ¥æ ‡æ³¨â€œæ³¨è§£ç±»å‹â€çš„â€œæ³¨è§£â€
		è¿™ä¸ªTargetæ³¨è§£ç”¨æ¥æ ‡æ³¨â€œè¢«æ ‡æ³¨çš„æ³¨è§£â€å¯ä»¥å‡ºç°åœ¨å“ªäº›ä½ç½®ä¸Šã€‚
	
		@Target(ElementType.METHOD)ï¼šè¡¨ç¤ºâ€œè¢«æ ‡æ³¨çš„æ³¨è§£â€åªèƒ½å‡ºç°åœ¨æ–¹æ³•ä¸Šã€‚
		@Target(value={CONSTRUCTOR, FIELD, LOCAL_VARIABLE, METHOD, PACKAGE, MODULE, PARAMETER, TYPE})
			è¡¨ç¤ºè¯¥æ³¨è§£å¯ä»¥å‡ºç°åœ¨ï¼š
				æ„é€ æ–¹æ³•ä¸Š
				å­—æ®µä¸Š
				å±€éƒ¨å˜é‡ä¸Š
				æ–¹æ³•ä¸Š
				....
				ç±»ä¸Š...



### å…³äºRetentionæ³¨è§£

		è¿™æ˜¯ä¸€ä¸ªå…ƒæ³¨è§£ï¼Œç”¨æ¥æ ‡æ³¨â€œæ³¨è§£ç±»å‹â€çš„â€œæ³¨è§£â€
		è¿™ä¸ªRetentionæ³¨è§£ç”¨æ¥æ ‡æ³¨â€œè¢«æ ‡æ³¨çš„æ³¨è§£â€æœ€ç»ˆä¿å­˜åœ¨å“ªé‡Œã€‚
	
		@Retention(RetentionPolicy.SOURCE)ï¼šè¡¨ç¤ºè¯¥æ³¨è§£åªè¢«ä¿ç•™åœ¨javaæºæ–‡ä»¶ä¸­ã€‚
		@Retention(RetentionPolicy.CLASS)ï¼šè¡¨ç¤ºè¯¥æ³¨è§£è¢«ä¿å­˜åœ¨classæ–‡ä»¶ä¸­ã€‚
		@Retention(RetentionPolicy.RUNTIME)ï¼šè¡¨ç¤ºè¯¥æ³¨è§£è¢«ä¿å­˜åœ¨classæ–‡ä»¶ä¸­ï¼Œå¹¶ä¸”å¯ä»¥è¢«åå°„æœºåˆ¶æ‰€è¯»å–ã€‚





## æ³¨è§£çš„å±æ€§

ä»¥`Deprecatedæ³¨è§£`æºç ä¸ºä¾‹ï¼Œä¸¤ä¸ªçº¢æ¡†çš„å°±æ˜¯å±æ€§ï¼ˆè™½ç„¶çœ‹ç€å¾ˆåƒæ–¹æ³•ï¼‰

æ³¨æ„å‡ ç‚¹ï¼š

1. å¦‚æœå±æ€§åé¢æ²¡åŠ `default`çš„è¯ï¼Œé‚£åœ¨ç”¨è¿™ä¸ªæ³¨è§£çš„æ—¶å€™ä¸€å®šè¦**æ˜¾å¼åœ°ç»™å‡º å±æ€§å = å±æ€§å€¼**
   - å¦‚ï¼š`@Deprecated(since = "1")`
2. å¦‚æœå±æ€§åæ˜¯`value`ä¸”**åªæœ‰è¿™ä¸€ä¸ªå±æ€§**çš„æ—¶å€™ï¼Œä½¿ç”¨æ³¨è§£**å¯ä»¥ä¸å†™å‡ºå±æ€§åï¼Œç›´æ¥ç»™å€¼å°±è¡Œ**
   - å¦‚æœé™¤äº†`value`è¿˜æœ‰å…¶ä»–å±æ€§çš„è¯ï¼Œå°±**ä¸èƒ½**çœç•¥å±æ€§åäº†ï¼ˆå¦‚ç¬¬äºŒè¡Œçš„`@Retention`æ³¨è§£ï¼Œåé¢æ²¡è·Ÿå±æ€§åï¼Œå®é™…ä¸Šå°±æ˜¯åªæœ‰ä¸€ä¸ªå«`value`çš„å±æ€§ï¼‰

![image-20220817142500568](https://s2.loli.net/2023/10/12/OgjBzNc8lxfrA41.png)



### å±æ€§ç±»å‹å¯ä»¥æ˜¯å“ªäº›

`byte short int long float double boolean char String Class æšä¸¾ç±»å‹`ä»¥åŠå®ƒä»¬çš„æ•°ç»„å½¢å¼

**æ³¨**ï¼šç”¨çš„æ—¶å€™å¦‚æœ**æ•°ç»„åªæœ‰ä¸€ä¸ªå…ƒç´ **çš„è¯ï¼Œå¯ä»¥**ä¸å†™**å¤§æ‹¬å·`{}`

#### ä»¥`Deprecatedæ³¨è§£`æºç ä¸ºä¾‹ï¼š

##### `@Retention`

- çº¢æ¡†ä½ç½®çœç•¥äº†å±æ€§åï¼Œæ‰€ä»¥`@Retention`æ³¨è§£å®é™…ä¸Šå°±æ˜¯åªæœ‰ä¸€ä¸ªå«`value`çš„å±æ€§

![image-20220817144209663](https://s2.loli.net/2023/10/12/jKRXhWBudiYStJF.png)

- åœ¨`Retentionæ³¨è§£`é‡Œæœ‰ä¸ª`RetentionPolicy value();`è¿›å…¥`RetentionPolicy` å¯ä»¥å‘ç°æ˜¯ä¸ª**æšä¸¾ç±»å‹**
- æ‰€ä»¥åœ¨`Deprecatedæ³¨è§£`ä¸ŠåŠ äº†`@Retention(RetentionPolicy.RUNTIME)`æ„å‘³ç€æ³¨è§£å¯ä»¥ä¿å­˜åœ¨å­—èŠ‚ç æ–‡ä»¶ä¸­ä¸”å¯ä»¥è¢«åå°„æœºåˆ¶è¯»å–
  - å¦‚æœæ˜¯`RetentionPolicy.SOURCE`ï¼Œè¡¨ç¤ºæ³¨è§£åªä¼šä¿ç•™åœ¨æºä»£ç ä¸­
  - å¦‚æœæ˜¯`RetentionPolicy.CLASS`ï¼Œä»£è¡¨ä¼šä¿å­˜è¿›å­—èŠ‚ç æ–‡ä»¶ä¸­

![image-20220817144315098](https://s2.loli.net/2023/10/12/iWr7SKGgPHjwtVn.png)

![image-20220817144409856](https://s2.loli.net/2023/10/12/G7H9f3KOVUIxS2h.png)

##### @Target

![image-20220817144706078](https://s2.loli.net/2023/10/12/2bhEgqjDkp4G5TH.png)

- ä¸ºä»€ä¹ˆå€¼åŠ äº†å¤§æ‹¬å·ï¼Ÿå› ä¸ºè¿™æ˜¯ä¸ª**æ•°ç»„**
- å› ä¸º`Target`é‡Œé¢**åªæœ‰ä¸€ä¸ªå«`value`çš„å±æ€§**ï¼Œæ‰€ä»¥å…¶å®ç”¨çš„æ—¶å€™**å¯ä»¥çœç•¥**`value`çš„

![image-20220817144928740](https://s2.loli.net/2023/10/12/opdQHqjeZCx4gu8.png)

- å†è¿›å…¥`ElementType`å¯ä»¥çœ‹å‡ºè¿™æ˜¯ä¸ª**æšä¸¾**





## åå°„æ³¨è§£

> 1. åˆ¤æ–­æœ‰æ²¡æœ‰æŸä¸ªæ³¨è§£
>    - é€šè¿‡`Classå¯¹è±¡.isAnnotationPresent(æ³¨è§£.class);`è·å–è¿™ä¸ªClasså¯¹è±¡æ˜¯å¦æœ‰è¿™ä¸ªæ³¨è§£ï¼Œæœ‰çš„è¯è¿”å›trueï¼Œæ²¡æœ‰è¿”å›false
> 2. è·å–æ³¨è§£
>    - é€šè¿‡`Classå¯¹è±¡.getAnnotation(æ³¨è§£.class);`è·å–æ³¨è§£å¯¹è±¡
>    - é€šè¿‡`æ³¨è§£å¯¹è±¡.å±æ€§å()`æ–¹å¼

å…ˆè‡ªå®šä¹‰ä¸ªæ³¨è§£

```java
import java.lang.annotation.ElementType;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;

/**
 * @author å°ç«å¨ƒ
 * @project_name: javase
 * @package_name: com.java.myanno
 */
// ä»£è¡¨åªç»™ç±»å’Œæ™®é€šæ–¹æ³•ç”¨
@Target({ElementType.TYPE, ElementType.METHOD})
// ä»£è¡¨è®©åå°„å¯ä»¥è·å–åˆ°
@Retention(RetentionPolicy.RUNTIME)
public @interface MyAnno {
    int value() default 0;
}
```



åœ¨å†™ä¸ªç±»ä½¿ç”¨æ³¨è§£

```java
/**
 * @author å°ç«å¨ƒ
 * @project_name: javase
 * @package_name: com.java.myanno
 */
@MyAnno(100)
public class MyAnnoTest {

}
```



é€šè¿‡åå°„è·å–æ³¨è§£å€¼

```java
import java.lang.annotation.Annotation;

/**
 * @author å°ç«å¨ƒ
 * @project_name: javase
 * @package_name: com.java.myanno
 */
public class MyReAnno {
    public static void main(String[] args) throws ClassNotFoundException {
        // è·å–ç±»
        Class<?> aClass = Class.forName("com.java.myanno.MyAnnoTest");

        // éå†æ‰€æœ‰æ³¨è§£
        // for (Annotation annotation : aClass.getAnnotations()) {
        //     System.out.println(annotation);
        // }

        // å¦‚æœMyAnnoæ³¨è§£å­˜åœ¨çš„è¯
        if (aClass.isAnnotationPresent(MyAnno.class)) {
            // è¾“å‡ºæ³¨è§£çš„å±æ€§å€¼
            // æ³¨æ„è¿™é‡Œçš„value()çš„valueæ˜¯å±æ€§åï¼ï¼ï¼ï¼
            System.out.println(aClass.getAnnotation(MyAnno.class).value());
        }

    }
}
```





## æ³¨è§£ä½œç”¨

å¯ä»¥ç”¨æ¥åˆ¤æ–­æœ‰è¿™ä¸ªæ³¨è§£æ€ä¹ˆæ ·ï¼Œæ²¡è¿™ä¸ªæ³¨è§£æ€ä¹ˆæ ·

å°±å¥½åƒ`@Override`æ³¨è§£åœ¨æ–¹æ³•ä¸Šæ—¶ï¼Œå°±è¦æ±‚æ–¹æ³•å¿…é¡»æ˜¯é‡å†™çš„ä¸€æ ·ï¼Œå¦åˆ™æŠ›å¼‚å¸¸











# æ‹“å±•

## æ–‡ä»¶ç›¸å¯¹è·¯å¾„

> IDEA ä¸‹æ–‡ä»¶é»˜è®¤ç›¸å¯¹ä½ç½®æ˜¯ä»`Projectæ ¹`å¼€å§‹çš„ï¼Œå†™è·¯å¾„ç›´æ¥ä»æ¨¡å—åå¼€å§‹ï¼Œç»§ç»­å¾€åå†™å°±è¡Œ

## è·å–æ–‡ä»¶çš„ç»å¯¹è·¯å¾„

é€šè¿‡`Thread.currentThread().getContextClassLoader().getResource("ç±»çš„æ ¹è·¯å¾„ä¸‹çš„ç›¸å¯¹è·¯å¾„").getPath();`å¯ä»¥è·å¾—æ–‡ä»¶çš„Stringç±»å‹çš„ç»å¯¹è·¯å¾„

é€šè¿‡`Thread.currentThread().getContextClassLoader().getResourceAsStream("ç±»çš„æ ¹è·¯å¾„ä¸‹çš„ç›¸å¯¹è·¯å¾„");`å¯ä»¥ä»¥æµçš„å½¢å¼è¿”å›

> å½“é¡¹ç›®ç§»åŠ¨åˆ°å…¶ä»–åœ°æ–¹åï¼Œæœ€å¥½è·å–æ–‡ä»¶çš„æ“ä½œæ˜¯åŠ¨æ€çš„
>
> ç”¨ä»¥ä¸‹æ–¹æ³•å¯ä»¥åŠ¨æ€è·å–æ–‡ä»¶è·¯å¾„ï¼ˆç»å¯¹è·¯å¾„ï¼‰ï¼Œä½†æ˜¯<font>å‰ææ˜¯ï¼šæ–‡ä»¶åœ¨æ ¹ç›®å½•ä¸‹ï¼ˆ`src`ï¼‰ä¸‹</font>
>
> 
>
> **æ³¨ï¼š**å…¶å®**æ ¹ç›®å½•ä¸æ˜¯src**ï¼Œè€Œæ˜¯åœ¨ç¼–è¯‘åå·¥ç¨‹ä¸‹æœ‰ä¸ª`out/production/è‡ªå·±å†™çš„æ¨¡å—`ï¼Œè¿™é‡Œé¢å°±**ç±»ä¼¼**æ˜¯srcç›®å½•ä¸‹çš„ä¸œè¥¿äº†ã€‚åªä¸è¿‡éƒ½æ˜¯ç¼–è¯‘è¿‡çš„ï¼Œ**Javaæ–‡ä»¶éƒ½æ˜¯.classçš„å­—èŠ‚ç æ–‡ä»¶**ï¼Œæ‰€ä»¥ç”¨è¿™ç§æ–¹å¼æ˜¯æ‹¿ä¸åˆ°.javaçš„æ–‡ä»¶çš„ï¼ˆä¼šæŠ¥ç©ºæŒ‡é’ˆå¼‚å¸¸ï¼‰

~~~java
/*
* è§£é‡Šï¼š
* Thread.currentThread() å½“å‰çº¿ç¨‹å¯¹è±¡
* getContextClassLoader() æ˜¯çº¿ç¨‹å¯¹è±¡çš„æ–¹æ³•ï¼Œå¯ä»¥è·å–åˆ°å½“å‰çº¿ç¨‹çš„ç±»åŠ è½½å™¨å¯¹è±¡ã€‚
* getResource() ã€è·å–èµ„æºã€‘è¿™æ˜¯ç±»åŠ è½½å™¨å¯¹è±¡çš„æ–¹æ³•ï¼Œå½“å‰çº¿ç¨‹çš„ç±»åŠ è½½å™¨é»˜è®¤ä»ç±»çš„æ ¹è·¯å¾„ä¸‹åŠ è½½èµ„æºã€‚
*/
String path = Thread.currentThread().getContextClassLoader()
    .getResource("classinfo2.properties").getPath(); // è¿™ç§æ–¹å¼è·å–æ–‡ä»¶ç»å¯¹è·¯å¾„æ˜¯é€šç”¨çš„ã€‚
~~~



## èµ„æºç»‘å®šå™¨

> èµ„æºç»‘å®šå™¨æ¥è‡ª`java.util.ResourceBundle`
>
> åœ¨ç”¨`ResourceBundle.getBundle("[åŒ…å/]db");`çš„æ—¶å€™ï¼Œ<font>å‰ææ˜¯ï¼šæ–‡ä»¶åœ¨æ ¹ç›®å½•ä¸‹ï¼ˆ`src`ï¼‰ä¸‹ï¼Œæ–‡ä»¶å¿…é¡»æ˜¯`.propertiesæ–‡ä»¶`</font>ï¼Œå†™åœ¨è·¯å¾„é‡Œçš„æ—¶å€™è¦**å»æ‰.propertiesåç¼€

```Java
import java.util.ResourceBundle;

/*
java.utilåŒ…ä¸‹æä¾›äº†ä¸€ä¸ªèµ„æºç»‘å®šå™¨ï¼Œä¾¿äºè·å–å±æ€§é…ç½®æ–‡ä»¶ä¸­çš„å†…å®¹ã€‚
ä½¿ç”¨ä»¥ä¸‹è¿™ç§æ–¹å¼çš„æ—¶å€™ï¼Œå±æ€§é…ç½®æ–‡ä»¶xxx.propertieså¿…é¡»æ”¾åˆ°ç±»è·¯å¾„ä¸‹ã€‚
 */
public class ResourceBundleTest {
    public static void main(String[] args) {

        // èµ„æºç»‘å®šå™¨ï¼Œåªèƒ½ç»‘å®šxxx.propertiesæ–‡ä»¶ã€‚å¹¶ä¸”è¿™ä¸ªæ–‡ä»¶å¿…é¡»åœ¨ç±»è·¯å¾„ä¸‹ã€‚æ–‡ä»¶æ‰©å±•åä¹Ÿå¿…é¡»æ˜¯properties
        // å¹¶ä¸”åœ¨å†™è·¯å¾„çš„æ—¶å€™ï¼Œè·¯å¾„åé¢çš„æ‰©å±•åä¸èƒ½å†™ã€‚
        //ResourceBundle bundle = ResourceBundle.getBundle("classinfo2");

        ResourceBundle bundle = ResourceBundle.getBundle("[åŒ…å/]db");

        String s = bundle.getString("key");
        System.out.println(s);

    }
}
```

## ç±»åŠ è½½å™¨

### ä»€ä¹ˆæ˜¯ç±»åŠ è½½å™¨

ä¸“é—¨è´Ÿè´£åŠ è½½ç±»çš„å‘½ä»¤/å·¥å…·ã€‚ClassLoader

### JDKä¸­è‡ªå¸¦äº†3ä¸ªç±»åŠ è½½å™¨

1. å¯åŠ¨ç±»åŠ è½½å™¨:rt.jar
2. æ‰©å±•ç±»åŠ è½½å™¨:ext/*.jar
3. åº”ç”¨ç±»åŠ è½½å™¨:classpath



### ç±»åŠ è½½å™¨åŠ è½½è¿‡ç¨‹

å‡è®¾æœ‰è¿™æ ·ä¸€æ®µä»£ç ï¼š`String s = "abc";`

ä»£ç åœ¨å¼€å§‹æ‰§è¡Œä¹‹å‰ï¼Œä¼šå°†æ‰€éœ€è¦ç±»å…¨éƒ¨åŠ è½½åˆ°JVMå½“ä¸­ã€‚é€šè¿‡ç±»åŠ è½½å™¨åŠ è½½ï¼Œçœ‹åˆ°ä»¥ä¸Šä»£ç ç±»åŠ è½½å™¨ä¼šæ‰¾`String.classæ–‡ä»¶`ï¼Œæ‰¾åˆ°å°±åŠ è½½ï¼ŒåŠ è½½è¿‡ç¨‹å¦‚ä¸‹ï¼š

1. é¦–å…ˆé€šè¿‡â€œå¯åŠ¨ç±»åŠ è½½å™¨â€åŠ è½½ã€‚
   - æ³¨æ„ï¼šå¯åŠ¨ç±»åŠ è½½å™¨ä¸“é—¨åŠ è½½ï¼š`C:\Program Files\Java\jdk1.8.0_101\jre\lib\rt.jar`
     - `rt.jar`ä¸­éƒ½æ˜¯JDKæœ€æ ¸å¿ƒçš„ç±»åº“
2. å¦‚æœé€šè¿‡â€œå¯åŠ¨ç±»åŠ è½½å™¨â€åŠ è½½ä¸åˆ°çš„æ—¶å€™ï¼Œä¼šé€šè¿‡"æ‰©å±•ç±»åŠ è½½å™¨"åŠ è½½ã€‚
   - æ³¨æ„ï¼šæ‰©å±•ç±»åŠ è½½å™¨ä¸“é—¨åŠ è½½ï¼š`C:\Program Files\Java\jdk1.8.0_101\jre\lib\ext\*.jar`
3. å¦‚æœâ€œæ‰©å±•ç±»åŠ è½½å™¨â€æ²¡æœ‰åŠ è½½åˆ°ï¼Œé‚£ä¹ˆä¼šé€šè¿‡â€œåº”ç”¨ç±»åŠ è½½å™¨â€åŠ è½½ã€‚
   - æ³¨æ„ï¼šåº”ç”¨ç±»åŠ è½½å™¨ä¸“é—¨åŠ è½½ï¼šclasspathä¸­çš„ç±»ã€‚



### åŒäº²å§”æ´¾æœºåˆ¶

> **ç®€å•è¯´å°±æ˜¯ç±»åŠ è½½çš„æ—¶å€™â€œå¯åŠ¨ç±»åŠ è½½å™¨â€ä¼˜å…ˆï¼Œ"æ‰©å±•ç±»åŠ è½½å™¨"ç¬¬äºŒï¼Œæœ€åæ‰â€œåº”ç”¨ç±»åŠ è½½å™¨â€**
>
> å› ä¸ºå¦‚æœå¿ƒæœºåµæµ‹ä¹‹äººå†™äº†å’ŒJavaè‡ªå¸¦çš„ç±»ä¸€æ ·çš„ç±»çš„è¯ï¼Œåœ¨é‡Œé¢åŠ¨äº†æ‰‹è„šï¼Œé‚£å¦‚æœå…ˆæ‰¾â€œåº”ç”¨ç±»åŠ è½½å™¨â€çš„è¯å°±ä¼šå…ˆæŠŠä»–å†™çš„ç±»åŠ è½½è¿›å»ï¼Œå¯èƒ½ä¼šé€ æˆå½±å“ã€‚

Javaä¸­ä¸ºäº†ä¿è¯ç±»åŠ è½½çš„å®‰å…¨ï¼Œä½¿ç”¨äº†åŒäº²å§”æ´¾æœºåˆ¶ã€‚**ä¼˜å…ˆä»å¯åŠ¨ç±»åŠ è½½å™¨ä¸­åŠ è½½**ï¼Œè¿™ä¸ªç§°ä¸ºâ€œçˆ¶â€ã€‚â€œçˆ¶â€æ— æ³•åŠ è½½åˆ°ï¼Œ**å†ä»æ‰©å±•ç±»åŠ è½½å™¨ä¸­åŠ è½½**ï¼Œè¿™ä¸ªç§°ä¸ºâ€œæ¯â€ã€‚åŒäº²å§”æ´¾ã€‚å¦‚æœéƒ½åŠ è½½ä¸åˆ°ï¼Œæ‰ä¼šè€ƒè™‘ä»åº”ç”¨ç±»åŠ è½½å™¨ä¸­åŠ è½½ã€‚ç›´åˆ°åŠ è½½åˆ°ä¸ºæ­¢ã€‚



## å¼‚å¸¸

å­ç±»é‡å†™çˆ¶ç±»çš„æ–¹æ³•ï¼Œå­ç±»**ä¸èƒ½**æ¯”çˆ¶ç±»æŠ›å‡º<u>æ›´å®½æ³›çš„æˆ–è€…æ›´å¤šçš„å¼‚å¸¸</u>



## å¯å˜é•¿åº¦å‚æ•°

å¯å˜é•¿åº¦å½¢å‚çš„å†™æ³•ï¼š`æ•°æ®ç±»å‹... å˜é‡å`

æ³¨æ„ï¼š

1. **ä¸‰ä¸ªç‚¹æ˜¯å¿…é¡»çš„**
2. **å‚æ•°è¦æ±‚å¯ä»¥æ˜¯0-nä¸ª**
3. å¯å˜é•¿åº¦å‚æ•°åœ¨å…¨éƒ¨å½¢å‚é‡Œ**åªèƒ½æœ‰ä¸€ä¸ª**ï¼Œè€Œä¸”å¿…é¡»åœ¨æœ€åçš„ä½ç½®ä¸Š
4. å¯å˜é•¿åº¦å‚æ•°å¯ä»¥å½“**åšä¸€ä¸ªæ•°ç»„æ¥çœ‹**

```java
package com.java.reflect;

public class ArgsTest {
    public static void main(String[] args) {
        m();
        m(10);
        m(10, 20);

        m2(100);
        m2(200, "abc");
        m2(200, "abc", "def");
        m2(200, "abc", "def", "xyz");

        m3("ab", "de", "kk", "ff");

        String[] strs = {"a","b","c"};
        // ä¹Ÿå¯ä»¥ä¼ 1ä¸ªæ•°ç»„
        m3(strs);

        // ç›´æ¥ä¼ 1ä¸ªæ•°ç»„
        m3(new String[]{"æˆ‘","æ˜¯","ä¸­","å›½", "äºº"}); //æ²¡å¿…è¦

        m3("æˆ‘","æ˜¯","ä¸­","å›½", "äºº");
    }

    public static void m(int... args){
        System.out.println("mæ–¹æ³•æ‰§è¡Œäº†ï¼");
    }

    //public static void m2(int... args2, String... args1){}

    // å¿…é¡»åœ¨æœ€åï¼Œåªèƒ½æœ‰1ä¸ªã€‚
    public static void m2(int a, String... args1){

    }

    public static void m3(String... args){
        //argsæœ‰lengthå±æ€§ï¼Œè¯´æ˜argsæ˜¯ä¸€ä¸ªæ•°ç»„ï¼
        // å¯ä»¥å°†å¯å˜é•¿åº¦å‚æ•°å½“åšä¸€ä¸ªæ•°ç»„æ¥çœ‹ã€‚
        for(int i = 0; i < args.length; i++){
            System.out.println(args[i]);
        }
    }

}
```

